"use strict";
/*!
    Shinobi v1.0.0000
    Copyright (c) MDE. All rights reserved.
*/
function byteTable(n){for(var i=new Uint8Array(n.length),t=0;t<n.length;++t)i[t]=n[t];return i}function z80_init(){z80_init_tables()}function z80_init_tables(){for(var t,i,r,n=0;n<256;n++){for(sz53_table[n]=n&168,t=n,r=0,i=0;i<8;i++)r^=t&1,t>>=1;parity_table[n]=r?0:4;sz53p_table[n]=sz53_table[n]|parity_table[n]}sz53_table[0]|=64;sz53p_table[0]|=64}function z80_reset(){z80.a=z80.f=z80.b=z80.c=z80.d=z80.e=z80.h=z80.l=0;z80.a_=z80.f_=z80.b_=z80.c_=z80.d_=z80.e_=z80.h_=z80.l_=0;z80.ixh=z80.ixl=z80.iyh=z80.iyl=0;z80.i=z80.r=z80.r7=0;z80.sp=z80.pc=0;z80.iff1=z80.iff2=z80.im=0;z80.halted=0;z80.irq_pending=!1;z80.irq_suppress=!0}function z80_set_irq(n){z80.irq_pending=n;z80.irq_pending&&z80.iff1&&z80_interrupt()}function z80_interrupt(){var n,t,i;if(z80.iff1){z80.halted&&(z80.pc++,z80.pc&=65535,z80.halted=!1);z80.iff1=z80.iff2=0;z80.sp=z80.sp-1&65535;writebyte(z80.sp,z80.pc>>8);z80.sp=z80.sp-1&65535;writebyte(z80.sp,z80.pc&255);z80.r=z80.r+1&127;switch(z80.im){case 0:z80.pc=56;tstates+=12;break;case 1:z80.pc=56;tstates+=13;break;case 2:n=256*z80.i+255;t=readbyte(n++);n&=4095;i=readbyte(n);z80.pc=t|i<<8;tstates+=19;break;default:ui_error(UI_ERROR_ERROR,"Unknown interrupt mode %d",z80.im);fuse_abort()}}}function z80_instruction_hook(){}function z80_nmi(){z80.iff1=0;z80.sp=z80.sp-1&65535;writebyte(z80.sp,z80.pc>>8);z80.sp=z80.sp-1&65535;writebyte(z80.sp,z80.pc&255);tstates+=11;z80.pc=102}function sign_extend(n){return n<128?n:n-256}function z80_defaults(n){for(var t=0;t<256;++t)n[t]||(n[t]=n[256])}function z80_edxx(n){z80_ed_ops[n]()}function z80_cbxx(n){z80_cb_ops[n]()}function z80_ddxx(n){z80_dd_ops[n]()}function z80_fdxx(n){z80_fd_ops[n]()}function z80_ddfdcbxx(n,t){z80_ddfdcb_ops[n](t)}function z80_do_opcodes(n){for(var i,t;tstates<event_next_event;)z80.irq_pending&&z80.iff1&&(z80.irq_suppress?z80.irq_suppress=!1:(z80.irq_suppress=!0,z80_interrupt())),i=tstates,tstates+=4,z80.r=z80.r+1&127,t=readbyte(z80.pc),z80_instruction_hook(z80.pc,t),z80.pc=z80.pc+1&65535,z80_base_ops[t](),n(tstates-i)}function vdp_writeaddr(n){if(vdp_addr_state===0)vdp_addr_state=1,vdp_addr_latch=n;else{vdp_addr_state=0;switch(n>>>6){case 0:case 1:vdp_mode_select=0;vdp_addr=vdp_addr_latch|(n&63)<<8;break;case 2:var t=n&15;vdp_regs[t]=vdp_addr_latch;switch(t){case 7:update_border()}break;case 3:vdp_mode_select=1;vdp_addr=vdp_addr_latch&31}}}function vdp_writepalette(n){function i(n){var t=n&3;return t|=t<<2,t|t<<4}var r=i(n),u=i(n>>>2),f=i(n>>>4),t=vdp_addr&31;paletteR[t]=r;paletteG[t]=u;paletteB[t]=f;paletteRGB[t]=4278190080|f<<16|u<<8|r;palette[t]=n;vdp_addr=vdp_addr+1&16383;update_border()}function vdp_writeram(n){var i,r,u;vram[vdp_addr]=n;var t=vdp_addr&16380,f=t*2,e=vram[t],o=vram[t+1],s=vram[t+2],h=vram[t+3];for(i=0;i<8;++i)r=7-i,u=e>>>r&1|(o>>>r&1)<<1|(s>>>r&1)<<2|(h>>>r&1)<<3,vramUntwiddled[f+i]=u;vdp_addr=vdp_addr+1&16383}function vdp_writebyte(n){vdp_addr_state=0;vdp_mode_select===0?vdp_writeram(n):vdp_writepalette(n)}function vdp_readram(){var n=vram[vdp_addr];return vdp_addr=vdp_addr+1&16383,n}function vdp_readpalette(){var n=palette[vdp_addr&31];return vdp_addr=vdp_addr+1&16383,n}function vdp_readbyte(){return vdp_addr_state=0,vdp_mode_select===0?vdp_readram():vdp_readpalette()}function update_border(){var n=16+(vdp_regs[7]&15);paletteRGB[n]!==prev_border&&(prev_border=paletteRGB[n],borderColourCss="rgb("+paletteR[n]+","+paletteG[n]+","+paletteB[n]+")")}function vdp_readstatus(){var n=vdp_status;return vdp_status&=31,vdp_pending_hblank=!1,z80_set_irq(!1),vdp_addr_state=0,n}function findSprites(n){var r=(vdp_regs[5]&126)<<7,u=[],f=8,i,t;for(vdp_regs[1]&2&&(f=16),i=0;i<64;i++){if(t=vram[r+i],t===208)break;if(t>=240&&(t-=256),n>=t&&n<t+f){if(u.length===8){vdp_status|=64;break}u.push([vram[r+128+i*2],vram[r+128+i*2+1],t])}}return u}function rasterize_background(n,t,i,r,u){var s,e,o,f;if(n=n|0,t=t|0,i=i|0,r=(r|0)*2,i&512?(e=-1,r+=7):e=1,o=i&2048?16:0,u&&o===0)for(s=0;s<8;s++)f=vramUntwiddled[r],r+=e,f!==0&&(fb32[n+t]=paletteRGB[f]),t=t+1&255;else f=vramUntwiddled[r]+o,r+=e,fb32[n+t]=paletteRGB[f],t=t+1&255,f=vramUntwiddled[r]+o,r+=e,fb32[n+t]=paletteRGB[f],t=t+1&255,f=vramUntwiddled[r]+o,r+=e,fb32[n+t]=paletteRGB[f],t=t+1&255,f=vramUntwiddled[r]+o,r+=e,fb32[n+t]=paletteRGB[f],t=t+1&255,f=vramUntwiddled[r]+o,r+=e,fb32[n+t]=paletteRGB[f],t=t+1&255,f=vramUntwiddled[r]+o,r+=e,fb32[n+t]=paletteRGB[f],t=t+1&255,f=vramUntwiddled[r]+o,r+=e,fb32[n+t]=paletteRGB[f],t=t+1&255,f=vramUntwiddled[r]+o,fb32[n+t]=paletteRGB[f]}function clear_background(n,t){n=n|0;t=t|0;for(var r=paletteRGB[0],i=0;i<8;++i)fb32[n+t]=r,t=t+1&255}function rasterize_background_line(n,t,i,r){var e,u;for(n=n|0,t=t|0,i=i|0,e=(r|0)*4,u=0;u<32;u++){var f=vram[i+u*2]|vram[i+u*2+1]<<8,s=f&511,o=32*s;o+=f&1024?28-e:e;(f&4096)==0?rasterize_background(n,t,f,o,!1):clear_background(n,t);t=t+8&255}}function rasterize_foreground_line(n,t,i,r){var e,u,f,s,o;for(n=n|0,t=t|0,i=i|0,e=(r|0)*4,u=0;u<32;u++)(f=vram[i+u*2]|vram[i+u*2+1]<<8,(f&4096)!=0)&&(s=f&511,o=32*s,o+=f&1024?28-e:e,rasterize_background(n,u*8+t&255,f,o,!0))}function rasterize_sprites(n,t,i,r){var c,u,o,s,f,h;for(t=t|0,i=i|0,c=vdp_regs[6]&4?8192:0,u=0;u<256;++u){var y=u,l=!1,a=!1,e=256;for(o=0;o<r.length;o++){if(s=r[o],f=y-s[0],f<0){h=-f;h<e&&(e=h);continue}if(!(f>=8)){l=!0;var p=n-s[2],w=c+s[1]*32+p*4,b=w*2+f,v=vramUntwiddled[b];if(v!==0){if(a){vdp_status|=32;break}fb32[t+(i+u-vdp_regs[8]&255)]=paletteRGB[16+v];a=!0}}}!l&&e>1&&(u+=e-1)}}function border_clear(n,t){var r,u,i;for(n=n|0,t=t|0,r=16+(vdp_regs[7]&15),u=paletteRGB[r],i=0;i<t;i++)fb32[n+i]=u}function rasterize_line(n){var t,i;if(n=n|0,t=n*256|0,(vdp_regs[1]&64)==0){border_clear(t,256);return}i=n+vdp_regs[9];i>=224&&(i-=224);var u=findSprites(n),r=vdp_regs[0]&64&&n<16?0:vdp_regs[8],f=(vdp_regs[2]<<10&14336)+(i>>>3)*64,e=i&7;rasterize_background_line(t,r,f,e);u.length&&rasterize_sprites(n,t,r,u);rasterize_foreground_line(t,r,f,e);vdp_regs[0]&32&&border_clear(t,8)}function vdp_frame_hook(){}function vdp_hblank(){var t=70,i=t+192,r=i+48+3,n;return vdp_current_line===t&&(vdp_hblank_counter=vdp_regs[10]),vdp_current_line>=t&&vdp_current_line<i&&(rasterize_line(vdp_current_line-t),--vdp_hblank_counter<0&&(vdp_hblank_counter=vdp_regs[10],vdp_pending_hblank=!0)),vdp_current_line++,n=0,vdp_current_line===r&&(vdp_current_line=0,vdp_status|=128,n|=4,currentFrame++,vdp_frame_hook(currentFrame),borderColourCss&&(canvas.style.borderColor=borderColourCss,borderColourCss=null)),vdp_regs[1]&32&&vdp_status&128&&(n|=2),vdp_regs[0]&16&&vdp_pending_hblank&&(n|=1),n}function vdp_init(){vram=new Uint8Array(16384);vramUntwiddled=new Uint8Array(32768);palette=new Uint8Array(32);paletteR=new Uint8Array(32);paletteG=new Uint8Array(32);paletteB=new Uint8Array(32);paletteRGB=new Uint32Array(32);vdp_regs=new Uint8Array(16);vdp_reset()}function vdp_reset(){for(var n=0;n<16384;n++)vram[n]=0;for(n=0;n<32;n++)paletteR[n]=paletteG[n]=paletteB[n]=paletteRGB[n]=palette[n]=0;for(n=0;n<16;n++)vdp_regs[n]=0;for(n=2;n<=5;n++)vdp_regs[n]=255;vdp_regs[6]=251;vdp_regs[10]=255;vdp_current_line=vdp_status=vdp_hblank_counter=0;vdp_mode_select=0}function vdp_get_line(){return vdp_current_line-64&255}function vdp_get_x(){return 0}function SoundChip(n,t){function ft(n,t,r,u){var f,h=i[n],e=l[n];if(h<=1){for(f=0;f<u;++f)t[f+r]+=e;return}for(f=0;f<u;++f)o[n]-=b,o[n]<0&&(o[n]+=h,s[n]=!s[n]),t[f+r]+=s[n]?e:-e}function d(){var n=r&1^(r&8)>>3;r=r>>1|n<<15}function et(){r>>=1;r===0&&(r=32768)}function g(){p=i[3]&4?d:et;r=32768}function ot(n){n=n|0;switch(i[n]&3){case 0:return 16;case 1:return 32;case 2:return 64;case 3:return i[n-1]}}function st(n,t,i,u){for(var h=ot(n),e=l[n],f=0;f<u;++f)o[n]-=b,o[n]<0&&(o[n]+=h,s[n]=!s[n],s[n]&&p()),t[f+i]+=r&1?e:-e}function nt(n,t,i){t=t|0;i=i|0;for(var r=0;r<i;++r)n[r+t]=0;if(w)for(r=0;r<4;++r)a[r](r,n,t,i)}function tt(){h&&rt(h);h=0}function ht(n,t,i){var u,r;for(tt(),u=e>i?i:e,r=0;r<u;++r)n[t+r]=c[r];for(t+=u,i-=u,r=u;r<e;++r)c[r-u]=c[r];e-=u;i!==0&&nt(n,t,i)}function rt(n){var i=n*ut+it,t=i|0;(it=i-t,e+t>=v&&(t=v-e),t!==0)&&(nt(c,e,t),e+=t)}function ct(n){var t,r;tt();t=!!(n&128);t&&(u=n>>5&3);(n&144)==144?(r=n&15,l[u]=y[r]):u===3?(i[u]=n&15,g()):i[u]=t?i[u]&-16|n&15:i[u]&15|(n&63)<<4}for(var b=3546893/16/n,ut=n/t,i=[0,0,0,0],o=[0,0,0,0],s=[!1,!1,!1,!1],l=[0,0,0,0],a=[null,null,null,null],y=[],k=1,r,p,w,h,u,f=0;f<16;++f)y[f]=k/a.length,k*=Math.pow(10,-.1);y[15]=0;r=0;p=d;w=!0;h=0;this.polltime=function(n){h+=n};var it=0,e=0,v=4096,c;for(c=typeof Float64Array!="undefined"?new Float64Array(v):new Float32Array(v),u=0,f=0;f<3;++f)a[f]=ft;a[3]=st;this.render=ht;this.poke=ct;this.reset=function(){for(var n=0;n<3;++n)o[n]=l[n]=i[n]=0;g();rt(1e5);h=0};this.enable=function(n){w=n}}function cycleCallback(n){soundChip.polltime(n)}function line(){tstates-=tstatesPerHblank;z80_do_opcodes(cycleCallback);var n=vdp_hblank(),t=!!(n&3);return(z80_set_irq(t),n&4)?(paintScreen(),!0):!1}function start(){initialized&&!running&&(running=!0,audio_enable(!x.storage.noaudio),run())}function run(){var n,t,i;initialized&&running&&((setTimeout(run,10),n=targetTimeout,t=Date.now(),n=t-lastFrame,n>pausedTimeout&&(n=targetTimeout),t-cyclet>999&&(t-cyclet-1e3<targetTimeout&&x.text("#game-fps",cycles),cycles=0,cyclet=t),n<targetTimeout)||(lastFrame=t-n%targetTimeout,cycles++,i=function(){if(running){for(var n=0;n<linesPerYield;++n)if(line())return;running&&setTimeout(i,0)}},i()))}function stop(){initialized&&running&&(running=!1,audio_enable(!1))}function reset(){miracle_reset()}function pumpAudio(n){var i=n.outputBuffer,t=i.getChannelData(0);soundChip.render(t,0,t.length)}function audio_init(){var n=null,t;if(typeof AudioContext!="undefined")n=new AudioContext;else if(typeof webkitAudioContext!="undefined")n=new webkitAudioContext;else{x.write("Unable to render audio");soundChip=new SoundChip(1e4,cpuHz);return}t=n.createScriptProcessor(4096,0,1);t.onaudioprocess=pumpAudio;t.connect(n.destination,0,0);soundChip=new SoundChip(n.sampleRate,cpuHz)}function audio_enable(n){x.storage.noaudio=!n;soundChip.enable(n)}function audio_reset(){soundChip.reset()}function audio_toggle(){audio_enable(x.storage.noaudio)}function miracle_init(){z80_init();vdp_init();audio_init();ram=new Uint8Array(8192);cartridgeRam=new Uint8Array(32768);pages=new Uint8Array(3);miracle_reset();canvas=document.getElementById("game-view");ctx=canvas.getContext("2d");ctx.getImageData?(imageData=ctx.getImageData(0,0,256,192),fb8=imageData.data,fb32=new Uint32Array(fb8.buffer)):alert("upgrade your browser, dude");document.onkeydown=keyDown;document.onkeyup=keyUp;document.onkeypress=keyPress;initialized=!0}function miracle_reset(){for(var n=0;n<8192;n++)ram[n]=0;for(n=0;n<32768;n++)cartridgeRam[n]=0;for(n=0;n<3;n++)pages[n]=n;ramSelectRegister=0;inputMode=7;z80_reset();vdp_reset();audio_reset()}function keyCode(n){return n.which||n.charCode||n.keyCode}function keyDown(n){if(running){var t=keys[keyCode(n)];if(t&&(joystick&=~t,!n.metaKey)){n.preventDefault();return}switch(n.keyCode){case 67:loadNextRom();break;case 70:x.app.toggleFullScreen();break;case 3:case 19:case 80:z80_nmi();break;case 85:audio_toggle()}}}function keyUp(n){if(running){var t=keys[keyCode(n)];t&&(joystick|=t,n.metaKey||n.preventDefault())}}function keyPress(n){running&&(n.metaKey||n.preventDefault())}function paintScreen(){ctx.putImageData(imageData,0,0)}function loadRom(n,t){var u=t.length/16384,i,r,f;for(console.log("Loading rom of "+u+" banks"),i=0;i<u;i++)for(romBanks[i]=new Uint8Array(16384),r=0;r<16384;r++)romBanks[i][r]=t.charCodeAt(i*16384+r);for(i=0;i<3;i++)pages[i]=i%u;romPageMask=u-1|0;f=romBanks[1][16380]<<8|romBanks[1][16381];console.log("Running "+n+" serial 0x"+hexword(f))}function hexbyte(n){return(n>>4&15).toString(16)+(n&15).toString(16)}function hexword(n){return(n>>12&15).toString(16)+(n>>8&15).toString(16)+(n>>4&15).toString(16)+(n&15).toString(16)}function virtualAddress(n){function t(n,t){return"rom"+n.toString(16)+"_"+hexword(t)}if(n<1024)return t(0,n);if(n<16384)return t(pages[0],n);if(n<32768)return t(pages[1],n-16384);if(n<49152)return(ramSelectRegister&12)==8?"crm_"+hexword(n-32768):(ramSelectRegister&12)==12?"crm_"+hexword(n-16384):t(pages[2],n-32768);if(n<57344)return"ram+"+hexword(n-49152);if(n<65532)return"ram_"+hexword(n-57344);switch(n){case 65532:return"rsr";case 65533:return"rpr_0";case 65534:return"rpr_1";case 65535:return"rpr_2"}return"unk_"+hexword(n)}function readbyte(n){n=n|0;var t=n>>>14&3;n&=16383;switch(t){case 0:return n<1024?romBanks[0][n]:romBanks[pages[0]][n];case 1:return romBanks[pages[1]][n];case 2:switch(ramSelectRegister&12){case 8:return cartridgeRam[n];case 12:return cartridgeRam[n+16384]}return romBanks[pages[2]][n];case 3:return ram[n&8191]}}function writebyte(n,t){if(n=n|0,t=t|0,n>=65532)switch(n){case 65532:ramSelectRegister=t;break;case 65533:t&=romPageMask;pages[0]=t;break;case 65534:t&=romPageMask;pages[1]=t;break;case 65535:t&=romPageMask;pages[2]=t;break;default:console.log("zoiks")}(n-=49152,n<0)||(ram[n&8191]=t)}function readport(n){n&=255;switch(n){case 126:return vdp_get_line();case 127:return vdp_get_x();case 220:case 192:return joystick&255;case 221:case 193:return joystick>>8&255;case 190:return vdp_readbyte();case 189:case 191:return vdp_readstatus();case 222:return 255;case 223:return 255;case 242:return 0;default:return console.log("IO port "+hexbyte(n)+"?"),255}}function writeport(n,t){t=t|0;n&=255;switch(n){case 63:var i=t>>5&1;(t&1)==0&&(i=1);joystick=joystick&-16385|i<<14;i=t>>7&1;(t&4)==0&&(i=1);joystick=joystick&-32769|i<<15;break;case 126:case 127:soundChip.poke(t);break;case 189:case 191:vdp_writeaddr(t);break;case 190:vdp_writebyte(t);break;case 222:inputMode=t;break;case 223:break;case 240:case 241:case 242:break;case 62:break;default:console.log("IO port "+hexbyte(n)+" = "+t)}}function loadRomData(n){var i,t;x.write("Loading "+n.title);i="roms/"+n.file;console.log("Loading rom data from "+i);t=new XMLHttpRequest;t.onload=function(){t.readyState===4&&(x.displayLoader(!1),t.status===200?(x.write("Rom loaded"),loadRom(n.title,t.response),start()):x.write("Rom loading error: "+t.statusText))};t.onerror=function(){x.displayLoader(!1);x.write(t.statusText)};t.open("GET",i,!0);t.overrideMimeType("text/plain; charset=x-user-defined");t.send();x.displayLoader()}function go(){miracle_init();miracle_reset();loadRomData(getLastRom())}function getLastRom(){return typeof localStorage!="undefined"&&localStorage.rom?(currentRom=localStorage.rom,roms[currentRom]):roms[0]}function loadNextRom(){if(miracle_reset(),currentRom=++currentRom%roms.length,typeof localStorage!="undefined")try{localStorage.rom=currentRom}catch(n){}loadRomData(roms[currentRom])}var global=window,z80_base_ops,z80_ed_ops,z80_cb_ops,z80_dd_ops,z80_fd_ops,z80_ddfdcb_ops,prev_border,borderColourCss,currentFrame,keys,running,currentRom;global.x={};global.strings={PlayerKeys:'Player1: <span class="key">W<\/span> <span class="key">A<\/span> <span class="key">S<\/span> <span class="key">D<\/span>/<span class="key">ARROWS<\/span> to move, <span class="key">SPACE<\/span>/<span class="key">Z<\/span> for fire 1, <span class="key">ENTER<\/span>/<span class="key">X<\/span> for fire 2.',PlayerMouse:'Player1: <span class="key">W<\/span> <span class="key">A<\/span> <span class="key">S<\/span> <span class="key">D<\/span>/<span class="key">ARROWS<\/span> keys to move, <span class="key">LEFT<\/span> button for fire 1, <span class="key">RIGHT<\/span> button for fire 2.',ConsoleKeys:'Console: <span class="key">PAUSE<\/span>/<span class="key">P<\/span> for Pause button, <span class="key">C<\/span> changes game, <span class="key">R<\/span> resets, <span class="key">U<\/span> audio, <span class="key">F<\/span> full-screen.'},function(){var n=global.x,i,t;n.versions=["m.JS core/1"];n.noop=function(){};i=+new Date;n.dt=function(){return n.tc()-i};n.tc=function(){return+new Date};"console"in window||(window.console={log:n.noop,assert:n.noop,trace:n.noop,debug:n.noop,info:n.noop,warn:n.noop,error:n.noop});n.E={ARG:"invalid argument",BROWSER:"no browser support",CLASSCTOR:"class constructor expected",FUNCTION:"function expected",INSTANCEOF:"instance of a class expected",SINGLEINST:"only one instance is allowed"};n.isDefined=function(n){return typeof n!="undefined"};n.isFunction=function(n){return typeof n=="function"};n.isNumber=function(n){return typeof n=="number"};n.isObject=function(n){return typeof n=="object"};n.isString=function(n){return typeof n=="string"||n instanceof String};n.isArray=function(n){return n instanceof Array};n.isCollection=function(t){return n.isArray(t)||t&&!n.isFunction(t)&&!n.isWindow(t)&&!n.isString(t)&&n.isNumber(t.length)};n.isWindow=function(t){return window.Window&&t instanceof Window||t&&n.isFunction(t.Object)};n.isFunction(Object.create)||(Object.create=function(){var t=function(){};return function(i){if(arguments.length>1)throw Error(n.E.ARG+": argument 2 not supported");if(!n.isObject(i))throw TypeError(": prototype");t.prototype=i;var r=new t;return t.prototype=null,r}}());n.isFunction(Function.prototype.bind)||(Function.prototype.bind=function(t){if(!n.isFunction(this))throw TypeError(n.E.FUNCTION);var u=Array.prototype.slice.call(arguments,1),i=function(){},f=this,r=function(){return f.apply(this instanceof i?this:t,u.concat(Array.prototype.slice.call(arguments)))};return i.prototype=this.prototype||null,r.prototype=new i,i.prototype=null,r});t=0;n.createClass=function(i,r,u,f){function e(){if(!(this instanceof e))return new e;n.isFunction(u)&&u.apply(this,arguments)}i=i||window;r=r||"<Anonymous_"+ ++t+">";i[r]=e;var o=e.prototype;return o.className=r,o.toString=function(){return"[object "+r+"]"},n.isFunction(f)&&f(o),e};n.extendClass=function(i,r,u,f,e){function o(){if(!(this instanceof o))return new o;i.apply(this,arguments);n.isFunction(f)&&f.apply(this,arguments)}if(!n.isFunction(i))throw Error(n.E.CLASSCTOR);r=r||window;u=u||"Anonymous_"+ ++t;o.prototype=Object.create(i.prototype);r[u]=o.prototype.constructor=o;var h=i.prototype,s=o.prototype;return s.className=u,s.toString=function(){return"[object "+u+"]"},n.isFunction(e)&&e(s,h),o};n.event=function(){return new n.Delegate};n.property=function(t,i,r){var u=null;return n.isDefined(t)&&(u=t),function(t){return n.isDefined(t)&&u!==t&&(!n.isFunction(i)||i(t)!==!1)&&(u=t,n.isFunction(i)&&r(t)),u}};n.createClass(n,"Delegate",function(){this._fList=[]},function(t){t.add=function(t){if(!n.isFunction(t))throw TypeError(n.E.FUNCTION);this._fList.push(t)};t.invoke=function(){for(var n=this._fList.length;n--;)this._fList[n].apply(this,arguments)};t.length=function(){return this._fList.length};t.remove=function(t){if(!n.isFunction(t))throw TypeError(n.E.FUNCTION);for(var i=this._fList.length;i--;)this._fList[i]===t&&this._fList.splice(i,1)}})}(),function(){var n=global.x,r,u,f,t,i;n.versions[0]+=" core.dom/1";n.all=function(t,i,r){var u,f;if(!t)throw Error(n.E.ARG+": elements");if(n.isString(t)&&!n.isFunction(document.querySelectorAll))throw Error(n.E.BROWSER);if(u=n.isString(t)?document.querySelectorAll(t):n.isArray(t)?t:[t],arguments.length>1){if(!n.isFunction(i))throw TypeError(n.E.FUNCTION);for(f=0;f<u.length;f++)i.call(this,u[f],r)}else return u};r="none";u="block";n.display=function(t,i){n.all(t,function(n,t){n.style.display=t},i===!1?r:i||u)};n.displayLayout=function(t){n.display(".x-layout",t)};n.displayLoader=function(t){n.display(".x-loader",t)};n.html=function(t,i){n.all(t,function(n){n.innerHTML=i})};f="textContent"in document?"textContent":"innerText"in document?"innerText":"innerHTML";n.text=function(t,i){n.all(t,function(n){n[f]=i})};t=[];i=0;n.cover=function(n){if(!t.cover){var r=document.createElement("div");r.id="x-cover";r.style.cssText="position:absolute;left:0;top:0;width:100%;height:100%;right:0;bottom:0;z-Index:10000;";document.body.appendChild(r);t.cover=r}i++;t.cover.innerHTML=n||"";t.cover.style.display=u};n.uncover=function(){i>0&&--i==0&&(t.cover.style.display=r)};n.write=function(n,i){var r,u,f;t.writeArea||(r=document.createElement("div"),r.style.cssText="position:absolute;left:0;top:0;pointer-events:none;z-Index:11000;",document.body.appendChild(r),t.writeArea=r);u=document.createElement("pre");f=document.createElement("span");f.style.cssText="background-color:#333333;background-color:rgba(0,0,0,0.50);color:white";f.innerHTML=n;u.appendChild(f);t.writeArea.appendChild(u);setTimeout(function(){t.writeArea.removeChild(u)},i*1e3||3e3)}}(),function(){function e(){document.body&&t&&(t.invoke(),t=null)}function o(){e();i&&(i.invoke(),i=null)}function s(){if(document.readyState==="interactive")e();else if(document.readyState==="complete")return o(),!0}var n=global.x,t,i,r,u,f;n.versions[0]+=" core.dom.compatibility/1";n.addEventHandler=window.addEventListener?function(t,i,r,u){n.all(t,function(n){n.addEventListener(i,r,!!u)})}:function(t,i,r){n.all(t,function(n){n.attachEvent("on"+i,r)})};t=new n.Delegate;i=new n.Delegate;s()||("DOMContentLoaded"in document?(n.addEventHandler(document,"DOMContentLoaded",e),n.addEventHandler(window,"load",o)):n.addEventHandler(document,"readystatechange",s));n.addContentLoadHandler=function(n){t?t.add(n):n()};n.addPageLoadHandler=function(n){i?i.add(n):n()};"onpointerdown"in window?(u="pointerdown",r=f="pointerup"):"ontouchstart"in window?(u="touchmove",r=f="touchend"):(r="click",u="mousedown",f="mouseup");n.addClickHandler=function(t,i,u){n.addEventHandler(t,r,i,u)};n.addPressHandler=function(t,i,r){n.addEventHandler(t,u,i,r)};n.addReleaseHandler=function(t,i,r){n.addEventHandler(t,f,i,r)};n.addPressReleaseHandlers=function(t,i,r,u){n.addPressHandler(t,i,u);n.addReleaseHandler(t,r,u)};n.cancelEvent=function(t){return t=t||window.event,t.stopImmediatePropagation?t.stopImmediatePropagation():t.stopPropagation&&t.stopPropagation(),n.isFunction(t.preventDefault)&&t.preventDefault(),t.returnValue=!1,t.cancelBubble=!0,!1}}(),function(){function c(){(t=n.app.initialize()===!1?!1:!0,t)&&("onvisibilitychange"in window?n.addEventHandler(document,"visibility",y,!1):(n.addEventHandler(window,"blur",r,!1),n.addEventHandler(window,"focus",h,!1)),n.addEventHandler(window,"keydown",o,!0),n.addEventHandler(window,"keyup",o,!0),n.addEventHandler(window,"resize",v,!0),s(),document.hasFocus()||r())}function l(){window.onerror=function(t,i,r,u,f){var e=f&&f.stack?f.stack:"Error : "+(t||"unknown")+(i&&r&&u?"\n   at "+i+":"+r+":"+u:"");n.app.critical(e)};t&&n.app.go()}function o(t){if((t=t||window.event,t)&&n.app.trapKeys()){var i=t.which||t.charCode||t.keyCode;if(i===116||i===82&&t.ctrlKey||i===8&&!a(t.target))return n.cancelEvent(t)}}function a(n){return n&&!n.disabled&&!n.readOnly&&["INPUT","SELECT","TEXTAREA"].indexOf(n.tagName)>-1}function v(){u&&clearTimeout(u);u=setTimeout(s,66)}function s(){var i=window.innerWidth||document.body.clientWidth,r=window.innerHeight||document.body.clientHeight;(f!==i||e!==r)&&(t&&n.app.layout(f=i,e=r),setTimeout(function(){window.scrollTo(0,1)},33))}function h(){i||r();i=!1;n.write("resume");t&&n.app.resume()}function r(){i||(i=!0,n.write("suspend"),t&&n.app.suspend())}function y(){n.write("visibility "+document.visibilityState);document.visibilityState==="hidden"?r():h()}var n=global.x,i;n.versions[0]+=" core.app/1";document.ondragstart=n.cancelEvent;document.ondrop=n.cancelEvent;document.ontouchmove=n.cancelEvent;n.createClass(n,"App",function(){if(n.app)throw Error(n.E.SINGLEINST+": "+this.className);n.app=this;n.addContentLoadHandler(c);n.addPageLoadHandler(l)},function(i){i.blue=function(i){if(!t)return document.body.innerHTML='<pre id="x-blue">'+i+"<\/pre>",!1;n.cover('<pre id="x-error">'+i+"<\/pre>")};i.critical=function(t){n.cover('<pre id="x-error"><h1>:{ CRASH!<\/h1>\n'+t+"\n"+n.versions.join("\n")+"<\/pre>")};i.initialize=function(){};i.go=function(){};i.layout=function(){};i.resume=function(){};i.suspend=function(){};i.trapKeys=n.property(!1);i.lockHistory=function(t){"history"in window&&n.isFunction(history.pushState)&&(t!==!1?"onpopstate"in window&&(window.onpopstate=null):(history.state!==this&&history.pushState(this,null,location.href),"onpopstate"in window&&(window.onpopstate=function(){history.go(1)})))}});var t=!1,f=-1,e=-1,u=0;i=!1}(),function(){var n=global.x;n.versions[0]+=" core.game/1";n.extendClass(n.App,n,"Game",function(){n.addEventHandler([document,window],"contextmenu",n.cancelEvent);this.lockHistory();this.trapKeys(!0)},function(t){var i=document.documentElement,r,u,f;i.requestFullscreen?(r="requestFullscreen",u="exitFullscreen",f="fullscreenElement"):i.mozRequestFullScreen?(r="mozRequestFullScreen",u="mozExitFullScreen",f="mozFullScreenElement"):i.webkitRequestFullscreen?(r="webkitRequestFullscreen",u="webkitExitFullscreen",f="webkitFullscreenElement"):i.msRequestFullscreen&&(r="msRequestFullscreen",u="msExitFullscreen",f="msFullscreenElement");t.fullScreen=function(n){n!==!1?i[r]():document[u]()};t.toggleFullScreen=function(){this.fullScreen(!document[f])};t.firstInput=null;t.onFirstInput=function(t,i,r){if(!n.isFunction(r))throw TypeError(n.E.FUNCTION);var u=this;i.keyboard&&document.addEventListener("keydown",function f(t){return document.removeEventListener("keydown",f,!0),u.firstInput||(u.firstInput="keyboard",r({keyboard:!0})),n.cancelEvent(t)},!0);i.mouse&&t.addEventListener("mousedown",function e(i){return t.removeEventListener("mousedown",e),u.firstInput||(u.firstInput="mouse",r({mouse:!0})),n.cancelEvent(i)});i.touch&&t.addEventListener("touchstart",function o(i){return t.removeEventListener("touchstart",o),u.firstInput||(u.firstInput="touch",r({touch:!0})),n.cancelEvent(i)})}})}(),function(){function t(t){var i=n.tc(),r=!1;try{t.test=i;r=t.test===i;t.removeItem("test")}catch(u){r=!1}}var n=global.x;n.versions[0]+=" core.storage/1";n.session=(n.haveSession="sessionStorage"in window&&t(sessionStorage)||!1)?sessionStorage:{};n.storage=(n.haveStorage="localStorage"in window&&t(localStorage)||!1)?localStorage:{}}(),function(){function t(t){n.input.gamepads[t.index]=t;n.input.gamepads.connected.invoke(t)}function i(t){n.input.gamepads.disconnected.invoke(t);n.input.gamepads[t.index]=null}var n=global.x;n.versions.push("m.input.gamepad/1");n.input=n.input||{};n.input.gamepads=[];n.input.gamepads.connected=n.event();n.input.gamepads.disconnected=n.event();"ongamepadconnected"in window?(window.addEventListener("gamepadconnected",function(n){t(n.gamepad)}),window.addEventListener("gamepaddisconnected",function(n){i(n.gamepad)})):(navigator.getGamepads||navigator.webkitGetGamepads)&&setInterval(function(){for(var u,f=navigator.getGamepads&&navigator.getGamepads()||navigator.webkitGetGamepads(),r=0;r<f.length;r++)u=f[r],n.input.gamepads[r]&&n.input.gamepads[r]!==u&&i(n.input.gamepads[r]),u&&t(u)},1e3)}(),function(){var n=global.x;n.versions.push("m.input.keyboard/1");n.input=n.input||{};n.input.keyboard=function(){function i(n){return n.which||n.charCode||n.keyCode}function r(n){t.keydown.invoke(i(n),n)}function u(n){t.keypress.invoke(i(n),n)}function f(n){t.keyup.invoke(i(n),n)}var t={};return t.keydown=n.event(),t.keypress=n.event(),t.keyup=n.event(),n.addEventHandler(document,"keydown",r,!0),n.addEventHandler(document,"keypress",u,!0),n.addEventHandler(document,"keyup",f,!0),t}()}();var halfcarry_add_table=byteTable([0,16,16,16,0,0,0,16]),halfcarry_sub_table=byteTable([0,0,16,0,16,0,16,16]),overflow_add_table=byteTable([0,0,0,4,4,0,0,0]),overflow_sub_table=byteTable([0,4,0,0,0,0,4,0]),sz53_table=new Uint8Array(256),parity_table=new Uint8Array(256),sz53p_table=new Uint8Array(256),z80={a:0,f:0,b:0,c:0,d:0,e:0,h:0,l:0,a_:0,f_:0,b_:0,c_:0,d_:0,e_:0,h_:0,l_:0,ixh:0,ixl:0,iyh:0,iyl:0,i:0,r:0,r7:0,sp:0,pc:0,iff1:0,iff2:0,im:0,halted:!1,irq_pending:!1,irq_suppress:!1};z80_base_ops=function(){var n=[];return n[0]=function(){},n[1]=function(){tstates+=6;z80.c=readbyte(z80.pc++);z80.pc&=65535;z80.b=readbyte(z80.pc++);z80.pc&=65535},n[2]=function(){tstates+=3;writebyte(z80.c|z80.b<<8,z80.a)},n[3]=function(){tstates+=2;var n=(z80.c|z80.b<<8)+1&65535;z80.b=n>>8;z80.c=n&255},n[4]=function(){z80.b=z80.b+1&255;z80.f=z80.f&1|(z80.b==128?4:0)|(z80.b&15?0:16)|sz53_table[z80.b]},n[5]=function(){z80.f=z80.f&1|(z80.b&15?0:16)|2;z80.b=z80.b-1&255;z80.f|=(z80.b==127?4:0)|sz53_table[z80.b]},n[6]=function(){tstates+=3;z80.b=readbyte(z80.pc++);z80.pc&=65535},n[7]=function(){z80.a=(z80.a&127)<<1|z80.a>>7;z80.f=z80.f&196|z80.a&41},n[8]=function(){var n=z80.a,t=z80.f;z80.a=z80.a_;z80.f=z80.f_;z80.a_=n;z80.f_=t},n[9]=function(){var n=(z80.l|z80.h<<8)+(z80.c|z80.b<<8),t=((z80.l|z80.h<<8)&2048)>>11|((z80.c|z80.b<<8)&2048)>>10|(n&2048)>>9;tstates+=7;z80.h=n>>8&255;z80.l=n&255;z80.f=z80.f&196|(n&65536?1:0)|n>>8&40|halfcarry_add_table[t]},n[10]=function(){tstates+=3;z80.a=readbyte(z80.c|z80.b<<8)},n[11]=function(){tstates+=2;var n=(z80.c|z80.b<<8)-1&65535;z80.b=n>>8;z80.c=n&255},n[12]=function(){z80.c=z80.c+1&255;z80.f=z80.f&1|(z80.c==128?4:0)|(z80.c&15?0:16)|sz53_table[z80.c]},n[13]=function(){z80.f=z80.f&1|(z80.c&15?0:16)|2;z80.c=z80.c-1&255;z80.f|=(z80.c==127?4:0)|sz53_table[z80.c]},n[14]=function(){tstates+=3;z80.c=readbyte(z80.pc++);z80.pc&=65535},n[15]=function(){z80.f=z80.f&196|z80.a&1;z80.a=z80.a>>1|(z80.a&1)<<7;z80.f|=z80.a&40},n[16]=function(){tstates+=4;z80.b=z80.b-1&255;z80.b&&(tstates+=5,z80.pc+=sign_extend(readbyte(z80.pc)),z80.pc&=65535);z80.pc++;z80.pc&=65535},n[17]=function(){tstates+=6;z80.e=readbyte(z80.pc++);z80.pc&=65535;z80.d=readbyte(z80.pc++);z80.pc&=65535},n[18]=function(){tstates+=3;writebyte(z80.e|z80.d<<8,z80.a)},n[19]=function(){tstates+=2;var n=(z80.e|z80.d<<8)+1&65535;z80.d=n>>8;z80.e=n&255},n[20]=function(){z80.d=z80.d+1&255;z80.f=z80.f&1|(z80.d==128?4:0)|(z80.d&15?0:16)|sz53_table[z80.d]},n[21]=function(){z80.f=z80.f&1|(z80.d&15?0:16)|2;z80.d=z80.d-1&255;z80.f|=(z80.d==127?4:0)|sz53_table[z80.d]},n[22]=function(){tstates+=3;z80.d=readbyte(z80.pc++);z80.pc&=65535},n[23]=function(){var n=z80.a;z80.a=(z80.a&127)<<1|z80.f&1;z80.f=z80.f&196|z80.a&40|n>>7},n[24]=function(){tstates+=3;tstates+=5;z80.pc+=sign_extend(readbyte(z80.pc));z80.pc&=65535;z80.pc++;z80.pc&=65535},n[25]=function(){var n=(z80.l|z80.h<<8)+(z80.e|z80.d<<8),t=((z80.l|z80.h<<8)&2048)>>11|((z80.e|z80.d<<8)&2048)>>10|(n&2048)>>9;tstates+=7;z80.h=n>>8&255;z80.l=n&255;z80.f=z80.f&196|(n&65536?1:0)|n>>8&40|halfcarry_add_table[t]},n[26]=function(){tstates+=3;z80.a=readbyte(z80.e|z80.d<<8)},n[27]=function(){tstates+=2;var n=(z80.e|z80.d<<8)-1&65535;z80.d=n>>8;z80.e=n&255},n[28]=function(){z80.e=z80.e+1&255;z80.f=z80.f&1|(z80.e==128?4:0)|(z80.e&15?0:16)|sz53_table[z80.e]},n[29]=function(){z80.f=z80.f&1|(z80.e&15?0:16)|2;z80.e=z80.e-1&255;z80.f|=(z80.e==127?4:0)|sz53_table[z80.e]},n[30]=function(){tstates+=3;z80.e=readbyte(z80.pc++);z80.pc&=65535},n[31]=function(){var n=z80.a;z80.a=z80.a>>1|(z80.f&1)<<7;z80.f=z80.f&196|z80.a&40|n&1},n[32]=function(){tstates+=3;z80.f&64||(tstates+=5,z80.pc+=sign_extend(readbyte(z80.pc)),z80.pc&=65535);z80.pc++;z80.pc&=65535},n[33]=function(){tstates+=6;z80.l=readbyte(z80.pc++);z80.pc&=65535;z80.h=readbyte(z80.pc++);z80.pc&=65535},n[34]=function(){var n;tstates+=12;n=readbyte(z80.pc++);z80.pc&=65535;n|=readbyte(z80.pc++)<<8;z80.pc&=65535;writebyte(n++,z80.l);n&=65535;writebyte(n,z80.h)},n[35]=function(){tstates+=2;var n=(z80.l|z80.h<<8)+1&65535;z80.h=n>>8;z80.l=n&255},n[36]=function(){z80.h=z80.h+1&255;z80.f=z80.f&1|(z80.h==128?4:0)|(z80.h&15?0:16)|sz53_table[z80.h]},n[37]=function(){z80.f=z80.f&1|(z80.h&15?0:16)|2;z80.h=z80.h-1&255;z80.f|=(z80.h==127?4:0)|sz53_table[z80.h]},n[38]=function(){tstates+=3;z80.h=readbyte(z80.pc++);z80.pc&=65535},n[39]=function(){var n=0,u=z80.f&1,i,r,t;(z80.f&16||(z80.a&15)>9)&&(n=6);(u||z80.a>153)&&(n|=96);z80.a>153&&(u=1);z80.f&2?(i=z80.a-n,t=(z80.a&136)>>3|(n&136)>>2|(i&136)>>1,z80.a=i&255,z80.f=(i&256?1:0)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|sz53_table[z80.a]):(r=z80.a+n,t=(z80.a&136)>>3|(n&136)>>2|(r&136)>>1,z80.a=r&255,z80.f=(r&256?1:0)|halfcarry_add_table[t&7]|overflow_add_table[t>>4]|sz53_table[z80.a]);z80.f=z80.f&-6|u|parity_table[z80.a]},n[40]=function(){tstates+=3;z80.f&64&&(tstates+=5,z80.pc+=sign_extend(readbyte(z80.pc)),z80.pc&=65535);z80.pc++;z80.pc&=65535},n[41]=function(){var n=(z80.l|z80.h<<8)+(z80.l|z80.h<<8),t=((z80.l|z80.h<<8)&2048)>>11|((z80.l|z80.h<<8)&2048)>>10|(n&2048)>>9;tstates+=7;z80.h=n>>8&255;z80.l=n&255;z80.f=z80.f&196|(n&65536?1:0)|n>>8&40|halfcarry_add_table[t]},n[42]=function(){var n;tstates+=12;n=readbyte(z80.pc++);z80.pc&=65535;n|=readbyte(z80.pc++)<<8;z80.pc&=65535;z80.l=readbyte(n++);n&=65535;z80.h=readbyte(n)},n[43]=function(){tstates+=2;var n=(z80.l|z80.h<<8)-1&65535;z80.h=n>>8;z80.l=n&255},n[44]=function(){z80.l=z80.l+1&255;z80.f=z80.f&1|(z80.l==128?4:0)|(z80.l&15?0:16)|sz53_table[z80.l]},n[45]=function(){z80.f=z80.f&1|(z80.l&15?0:16)|2;z80.l=z80.l-1&255;z80.f|=(z80.l==127?4:0)|sz53_table[z80.l]},n[46]=function(){tstates+=3;z80.l=readbyte(z80.pc++);z80.pc&=65535},n[47]=function(){z80.a^=255;z80.f=z80.f&197|z80.a&40|18},n[48]=function(){tstates+=3;z80.f&1||(tstates+=5,z80.pc+=sign_extend(readbyte(z80.pc)),z80.pc&=65535);z80.pc++;z80.pc&=65535},n[49]=function(){var n,t;tstates+=6;n=readbyte(z80.pc++);z80.pc&=65535;t=readbyte(z80.pc++);z80.sp=n|t<<8;z80.pc&=65535},n[50]=function(){tstates+=3;var n=readbyte(z80.pc++);z80.pc&=65535;tstates+=6;n|=readbyte(z80.pc++)<<8;z80.pc&=65535;writebyte(n,z80.a)},n[51]=function(){tstates+=2;z80.sp=z80.sp+1&65535},n[52]=function(){tstates+=7;var n=readbyte(z80.l|z80.h<<8);n=n+1&255;z80.f=z80.f&1|(n==128?4:0)|(n&15?0:16)|sz53_table[n];writebyte(z80.l|z80.h<<8,n)},n[53]=function(){tstates+=7;var n=readbyte(z80.l|z80.h<<8);z80.f=z80.f&1|(n&15?0:16)|2;n=n-1&255;z80.f|=(n==127?4:0)|sz53_table[n];writebyte(z80.l|z80.h<<8,n)},n[54]=function(){tstates+=6;writebyte(z80.l|z80.h<<8,readbyte(z80.pc++));z80.pc&=65535},n[55]=function(){z80.f=z80.f&196|z80.a&40|1},n[56]=function(){tstates+=3;z80.f&1&&(tstates+=5,z80.pc+=sign_extend(readbyte(z80.pc)),z80.pc&=65535);z80.pc++;z80.pc&=65535},n[57]=function(){var n=(z80.l|z80.h<<8)+z80.sp,t=((z80.l|z80.h<<8)&2048)>>11|(z80.sp&2048)>>10|(n&2048)>>9;tstates+=7;z80.h=n>>8&255;z80.l=n&255;z80.f=z80.f&196|(n&65536?1:0)|n>>8&40|halfcarry_add_table[t]},n[58]=function(){var n;tstates+=9;n=readbyte(z80.pc++);z80.pc&=65535;n|=readbyte(z80.pc++)<<8;z80.pc&=65535;z80.a=readbyte(n)},n[59]=function(){tstates+=2;z80.sp=z80.sp-1&65535},n[60]=function(){z80.a=z80.a+1&255;z80.f=z80.f&1|(z80.a==128?4:0)|(z80.a&15?0:16)|sz53_table[z80.a]},n[61]=function(){z80.f=z80.f&1|(z80.a&15?0:16)|2;z80.a=z80.a-1&255;z80.f|=(z80.a==127?4:0)|sz53_table[z80.a]},n[62]=function(){tstates+=3;z80.a=readbyte(z80.pc++);z80.pc&=65535},n[63]=function(){z80.f=z80.f&196|(z80.f&1?16:1)|z80.a&40},n[64]=function(){},n[65]=function(){z80.b=z80.c},n[66]=function(){z80.b=z80.d},n[67]=function(){z80.b=z80.e},n[68]=function(){z80.b=z80.h},n[69]=function(){z80.b=z80.l},n[70]=function(){tstates+=3;z80.b=readbyte(z80.l|z80.h<<8)},n[71]=function(){z80.b=z80.a},n[72]=function(){z80.c=z80.b},n[73]=function(){},n[74]=function(){z80.c=z80.d},n[75]=function(){z80.c=z80.e},n[76]=function(){z80.c=z80.h},n[77]=function(){z80.c=z80.l},n[78]=function(){tstates+=3;z80.c=readbyte(z80.l|z80.h<<8)},n[79]=function(){z80.c=z80.a},n[80]=function(){z80.d=z80.b},n[81]=function(){z80.d=z80.c},n[82]=function(){},n[83]=function(){z80.d=z80.e},n[84]=function(){z80.d=z80.h},n[85]=function(){z80.d=z80.l},n[86]=function(){tstates+=3;z80.d=readbyte(z80.l|z80.h<<8)},n[87]=function(){z80.d=z80.a},n[88]=function(){z80.e=z80.b},n[89]=function(){z80.e=z80.c},n[90]=function(){z80.e=z80.d},n[91]=function(){},n[92]=function(){z80.e=z80.h},n[93]=function(){z80.e=z80.l},n[94]=function(){tstates+=3;z80.e=readbyte(z80.l|z80.h<<8)},n[95]=function(){z80.e=z80.a},n[96]=function(){z80.h=z80.b},n[97]=function(){z80.h=z80.c},n[98]=function(){z80.h=z80.d},n[99]=function(){z80.h=z80.e},n[100]=function(){},n[101]=function(){z80.h=z80.l},n[102]=function(){tstates+=3;z80.h=readbyte(z80.l|z80.h<<8)},n[103]=function(){z80.h=z80.a},n[104]=function(){z80.l=z80.b},n[105]=function(){z80.l=z80.c},n[106]=function(){z80.l=z80.d},n[107]=function(){z80.l=z80.e},n[108]=function(){z80.l=z80.h},n[109]=function(){},n[110]=function(){tstates+=3;z80.l=readbyte(z80.l|z80.h<<8)},n[111]=function(){z80.l=z80.a},n[112]=function(){tstates+=3;writebyte(z80.l|z80.h<<8,z80.b)},n[113]=function(){tstates+=3;writebyte(z80.l|z80.h<<8,z80.c)},n[114]=function(){tstates+=3;writebyte(z80.l|z80.h<<8,z80.d)},n[115]=function(){tstates+=3;writebyte(z80.l|z80.h<<8,z80.e)},n[116]=function(){tstates+=3;writebyte(z80.l|z80.h<<8,z80.h)},n[117]=function(){tstates+=3;writebyte(z80.l|z80.h<<8,z80.l)},n[118]=function(){z80.halted=1;z80.pc--;z80.pc&=65535},n[119]=function(){tstates+=3;writebyte(z80.l|z80.h<<8,z80.a)},n[120]=function(){z80.a=z80.b},n[121]=function(){z80.a=z80.c},n[122]=function(){z80.a=z80.d},n[123]=function(){z80.a=z80.e},n[124]=function(){z80.a=z80.h},n[125]=function(){z80.a=z80.l},n[126]=function(){tstates+=3;z80.a=readbyte(z80.l|z80.h<<8)},n[127]=function(){},n[128]=function(){var n=z80.a+z80.b,t=(z80.a&136)>>3|(z80.b&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[t&7]|overflow_add_table[t>>4]|sz53_table[z80.a]},n[129]=function(){var n=z80.a+z80.c,t=(z80.a&136)>>3|(z80.c&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[t&7]|overflow_add_table[t>>4]|sz53_table[z80.a]},n[130]=function(){var n=z80.a+z80.d,t=(z80.a&136)>>3|(z80.d&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[t&7]|overflow_add_table[t>>4]|sz53_table[z80.a]},n[131]=function(){var n=z80.a+z80.e,t=(z80.a&136)>>3|(z80.e&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[t&7]|overflow_add_table[t>>4]|sz53_table[z80.a]},n[132]=function(){var n=z80.a+z80.h,t=(z80.a&136)>>3|(z80.h&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[t&7]|overflow_add_table[t>>4]|sz53_table[z80.a]},n[133]=function(){var n=z80.a+z80.l,t=(z80.a&136)>>3|(z80.l&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[t&7]|overflow_add_table[t>>4]|sz53_table[z80.a]},n[134]=function(){tstates+=3;var t=readbyte(z80.l|z80.h<<8),n=z80.a+t,i=(z80.a&136)>>3|(t&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[i&7]|overflow_add_table[i>>4]|sz53_table[z80.a]},n[135]=function(){var n=z80.a+z80.a,t=(z80.a&136)>>3|(z80.a&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[t&7]|overflow_add_table[t>>4]|sz53_table[z80.a]},n[136]=function(){var n=z80.a+z80.b+(z80.f&1),t=(z80.a&136)>>3|(z80.b&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[t&7]|overflow_add_table[t>>4]|sz53_table[z80.a]},n[137]=function(){var n=z80.a+z80.c+(z80.f&1),t=(z80.a&136)>>3|(z80.c&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[t&7]|overflow_add_table[t>>4]|sz53_table[z80.a]},n[138]=function(){var n=z80.a+z80.d+(z80.f&1),t=(z80.a&136)>>3|(z80.d&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[t&7]|overflow_add_table[t>>4]|sz53_table[z80.a]},n[139]=function(){var n=z80.a+z80.e+(z80.f&1),t=(z80.a&136)>>3|(z80.e&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[t&7]|overflow_add_table[t>>4]|sz53_table[z80.a]},n[140]=function(){var n=z80.a+z80.h+(z80.f&1),t=(z80.a&136)>>3|(z80.h&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[t&7]|overflow_add_table[t>>4]|sz53_table[z80.a]},n[141]=function(){var n=z80.a+z80.l+(z80.f&1),t=(z80.a&136)>>3|(z80.l&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[t&7]|overflow_add_table[t>>4]|sz53_table[z80.a]},n[142]=function(){tstates+=3;var t=readbyte(z80.l|z80.h<<8),n=z80.a+t+(z80.f&1),i=(z80.a&136)>>3|(t&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[i&7]|overflow_add_table[i>>4]|sz53_table[z80.a]},n[143]=function(){var n=z80.a+z80.a+(z80.f&1),t=(z80.a&136)>>3|(z80.a&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[t&7]|overflow_add_table[t>>4]|sz53_table[z80.a]},n[144]=function(){var n=z80.a-z80.b,t=(z80.a&136)>>3|(z80.b&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|sz53_table[z80.a]},n[145]=function(){var n=z80.a-z80.c,t=(z80.a&136)>>3|(z80.c&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|sz53_table[z80.a]},n[146]=function(){var n=z80.a-z80.d,t=(z80.a&136)>>3|(z80.d&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|sz53_table[z80.a]},n[147]=function(){var n=z80.a-z80.e,t=(z80.a&136)>>3|(z80.e&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|sz53_table[z80.a]},n[148]=function(){var n=z80.a-z80.h,t=(z80.a&136)>>3|(z80.h&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|sz53_table[z80.a]},n[149]=function(){var n=z80.a-z80.l,t=(z80.a&136)>>3|(z80.l&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|sz53_table[z80.a]},n[150]=function(){tstates+=3;var t=readbyte(z80.l|z80.h<<8),n=z80.a-t,i=(z80.a&136)>>3|(t&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[i&7]|overflow_sub_table[i>>4]|sz53_table[z80.a]},n[151]=function(){var n=z80.a-z80.a,t=(z80.a&136)>>3|(z80.a&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|sz53_table[z80.a]},n[152]=function(){var n=z80.a-z80.b-(z80.f&1),t=(z80.a&136)>>3|(z80.b&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|sz53_table[z80.a]},n[153]=function(){var n=z80.a-z80.c-(z80.f&1),t=(z80.a&136)>>3|(z80.c&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|sz53_table[z80.a]},n[154]=function(){var n=z80.a-z80.d-(z80.f&1),t=(z80.a&136)>>3|(z80.d&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|sz53_table[z80.a]},n[155]=function(){var n=z80.a-z80.e-(z80.f&1),t=(z80.a&136)>>3|(z80.e&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|sz53_table[z80.a]},n[156]=function(){var n=z80.a-z80.h-(z80.f&1),t=(z80.a&136)>>3|(z80.h&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|sz53_table[z80.a]},n[157]=function(){var n=z80.a-z80.l-(z80.f&1),t=(z80.a&136)>>3|(z80.l&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|sz53_table[z80.a]},n[158]=function(){tstates+=3;var t=readbyte(z80.l|z80.h<<8),n=z80.a-t-(z80.f&1),i=(z80.a&136)>>3|(t&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[i&7]|overflow_sub_table[i>>4]|sz53_table[z80.a]},n[159]=function(){var n=z80.a-z80.a-(z80.f&1),t=(z80.a&136)>>3|(z80.a&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|sz53_table[z80.a]},n[160]=function(){z80.a&=z80.b;z80.f=16|sz53p_table[z80.a]},n[161]=function(){z80.a&=z80.c;z80.f=16|sz53p_table[z80.a]},n[162]=function(){z80.a&=z80.d;z80.f=16|sz53p_table[z80.a]},n[163]=function(){z80.a&=z80.e;z80.f=16|sz53p_table[z80.a]},n[164]=function(){z80.a&=z80.h;z80.f=16|sz53p_table[z80.a]},n[165]=function(){z80.a&=z80.l;z80.f=16|sz53p_table[z80.a]},n[166]=function(){tstates+=3;var n=readbyte(z80.l|z80.h<<8);z80.a&=n;z80.f=16|sz53p_table[z80.a]},n[167]=function(){z80.a&=z80.a;z80.f=16|sz53p_table[z80.a]},n[168]=function(){z80.a^=z80.b;z80.f=sz53p_table[z80.a]},n[169]=function(){z80.a^=z80.c;z80.f=sz53p_table[z80.a]},n[170]=function(){z80.a^=z80.d;z80.f=sz53p_table[z80.a]},n[171]=function(){z80.a^=z80.e;z80.f=sz53p_table[z80.a]},n[172]=function(){z80.a^=z80.h;z80.f=sz53p_table[z80.a]},n[173]=function(){z80.a^=z80.l;z80.f=sz53p_table[z80.a]},n[174]=function(){tstates+=3;var n=readbyte(z80.l|z80.h<<8);z80.a^=n;z80.f=sz53p_table[z80.a]},n[175]=function(){z80.a^=z80.a;z80.f=sz53p_table[z80.a]},n[176]=function(){z80.a|=z80.b;z80.f=sz53p_table[z80.a]},n[177]=function(){z80.a|=z80.c;z80.f=sz53p_table[z80.a]},n[178]=function(){z80.a|=z80.d;z80.f=sz53p_table[z80.a]},n[179]=function(){z80.a|=z80.e;z80.f=sz53p_table[z80.a]},n[180]=function(){z80.a|=z80.h;z80.f=sz53p_table[z80.a]},n[181]=function(){z80.a|=z80.l;z80.f=sz53p_table[z80.a]},n[182]=function(){tstates+=3;var n=readbyte(z80.l|z80.h<<8);z80.a|=n;z80.f=sz53p_table[z80.a]},n[183]=function(){z80.a|=z80.a;z80.f=sz53p_table[z80.a]},n[184]=function(){var n=z80.a-z80.b,t=(z80.a&136)>>3|(z80.b&136)>>2|(n&136)>>1;z80.f=(n&256?1:n?0:64)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|z80.b&40|n&128},n[185]=function(){var n=z80.a-z80.c,t=(z80.a&136)>>3|(z80.c&136)>>2|(n&136)>>1;z80.f=(n&256?1:n?0:64)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|z80.c&40|n&128},n[186]=function(){var n=z80.a-z80.d,t=(z80.a&136)>>3|(z80.d&136)>>2|(n&136)>>1;z80.f=(n&256?1:n?0:64)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|z80.d&40|n&128},n[187]=function(){var n=z80.a-z80.e,t=(z80.a&136)>>3|(z80.e&136)>>2|(n&136)>>1;z80.f=(n&256?1:n?0:64)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|z80.e&40|n&128},n[188]=function(){var n=z80.a-z80.h,t=(z80.a&136)>>3|(z80.h&136)>>2|(n&136)>>1;z80.f=(n&256?1:n?0:64)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|z80.h&40|n&128},n[189]=function(){var n=z80.a-z80.l,t=(z80.a&136)>>3|(z80.l&136)>>2|(n&136)>>1;z80.f=(n&256?1:n?0:64)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|z80.l&40|n&128},n[190]=function(){tstates+=3;var t=readbyte(z80.l|z80.h<<8),n=z80.a-t,i=(z80.a&136)>>3|(t&136)>>2|(n&136)>>1;z80.f=(n&256?1:n?0:64)|2|halfcarry_sub_table[i&7]|overflow_sub_table[i>>4]|t&40|n&128},n[191]=function(){var n=z80.a-z80.a,t=(z80.a&136)>>3|(z80.a&136)>>2|(n&136)>>1;z80.f=(n&256?1:n?0:64)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|z80.a&40|n&128},n[192]=function(){var n,t;tstates++;z80.f&64||(tstates+=6,n=readbyte(z80.sp++),z80.sp&=65535,t=readbyte(z80.sp++),z80.sp&=65535,z80.pc=n|t<<8)},n[193]=function(){tstates+=6;z80.c=readbyte(z80.sp++);z80.sp&=65535;z80.b=readbyte(z80.sp++);z80.sp&=65535},n[194]=function(){var n,t,i;tstates+=6;z80.f&64?z80.pc+=2:(n=z80.pc,t=readbyte(n++),n&=65535,i=readbyte(n),z80.pc=t|i<<8)},n[195]=function(){var n,t,i;tstates+=6;n=z80.pc;t=readbyte(n++);n&=65535;i=readbyte(n);z80.pc=t|i<<8},n[196]=function(){var n,t,i,r;tstates+=6;z80.f&64?z80.pc+=2:(n=readbyte(z80.pc++),z80.pc&=65535,tstates++,t=readbyte(z80.pc++),z80.pc&=65535,tstates+=6,z80.sp--,z80.sp&=65535,writebyte(z80.sp,z80.pc>>8),z80.sp--,z80.sp&=65535,writebyte(z80.sp,z80.pc&255),i=n,r=t,z80.pc=i|r<<8)},n[197]=function(){tstates++;tstates+=6;z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.b);z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.c)},n[198]=function(){tstates+=3;var t=readbyte(z80.pc++),n=z80.a+t,i=(z80.a&136)>>3|(t&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[i&7]|overflow_add_table[i>>4]|sz53_table[z80.a]},n[199]=function(){tstates++;tstates+=6;z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.pc>>8);z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.pc&255);z80.pc=0},n[200]=function(){var n,t;tstates++;z80.f&64&&(tstates+=6,n=readbyte(z80.sp++),z80.sp&=65535,t=readbyte(z80.sp++),z80.sp&=65535,z80.pc=n|t<<8)},n[201]=function(){var n,t;tstates+=6;n=readbyte(z80.sp++);z80.sp&=65535;t=readbyte(z80.sp++);z80.sp&=65535;z80.pc=n|t<<8},n[202]=function(){var n,t,i;tstates+=6;z80.f&64?(n=z80.pc,t=readbyte(n++),n&=65535,i=readbyte(n),z80.pc=t|i<<8):z80.pc+=2},n[203]=function(){var n;tstates+=4;n=readbyte(z80.pc++);z80.pc&=65535;z80.r=z80.r+1&127;z80_cbxx(n)},n[204]=function(){var n,t,i,r;tstates+=6;z80.f&64?(n=readbyte(z80.pc++),z80.pc&=65535,tstates++,t=readbyte(z80.pc++),z80.pc&=65535,tstates+=6,z80.sp--,z80.sp&=65535,writebyte(z80.sp,z80.pc>>8),z80.sp--,z80.sp&=65535,writebyte(z80.sp,z80.pc&255),i=n,r=t,z80.pc=i|r<<8):z80.pc+=2},n[205]=function(){var n,t,i,r;tstates+=6;n=readbyte(z80.pc++);z80.pc&=65535;tstates++;t=readbyte(z80.pc++);z80.pc&=65535;tstates+=6;z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.pc>>8);z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.pc&255);i=n;r=t;z80.pc=i|r<<8},n[206]=function(){tstates+=3;var t=readbyte(z80.pc++),n=z80.a+t+(z80.f&1),i=(z80.a&136)>>3|(t&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[i&7]|overflow_add_table[i>>4]|sz53_table[z80.a]},n[207]=function(){tstates++;tstates+=6;z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.pc>>8);z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.pc&255);z80.pc=8},n[208]=function(){var n,t;tstates++;z80.f&1||(tstates+=6,n=readbyte(z80.sp++),z80.sp&=65535,t=readbyte(z80.sp++),z80.sp&=65535,z80.pc=n|t<<8)},n[209]=function(){tstates+=6;z80.e=readbyte(z80.sp++);z80.sp&=65535;z80.d=readbyte(z80.sp++);z80.sp&=65535},n[210]=function(){var n,t,i;tstates+=6;z80.f&1?z80.pc+=2:(n=z80.pc,t=readbyte(n++),n&=65535,i=readbyte(n),z80.pc=t|i<<8)},n[211]=function(){var n;tstates+=4;n=readbyte(z80.pc++)+(z80.a<<8);z80.pc&=65535;tstates+=3;writeport(n,z80.a)},n[212]=function(){var n,t,i,r;tstates+=6;z80.f&1?z80.pc+=2:(n=readbyte(z80.pc++),z80.pc&=65535,tstates++,t=readbyte(z80.pc++),z80.pc&=65535,tstates+=6,z80.sp--,z80.sp&=65535,writebyte(z80.sp,z80.pc>>8),z80.sp--,z80.sp&=65535,writebyte(z80.sp,z80.pc&255),i=n,r=t,z80.pc=i|r<<8)},n[213]=function(){tstates++;tstates+=6;z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.d);z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.e)},n[214]=function(){tstates+=3;var t=readbyte(z80.pc++),n=z80.a-t,i=(z80.a&136)>>3|(t&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[i&7]|overflow_sub_table[i>>4]|sz53_table[z80.a]},n[215]=function(){tstates++;tstates+=6;z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.pc>>8);z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.pc&255);z80.pc=16},n[216]=function(){var n,t;tstates++;z80.f&1&&(tstates+=6,n=readbyte(z80.sp++),z80.sp&=65535,t=readbyte(z80.sp++),z80.sp&=65535,z80.pc=n|t<<8)},n[217]=function(){var n;n=z80.b;z80.b=z80.b_;z80.b_=n;n=z80.c;z80.c=z80.c_;z80.c_=n;n=z80.d;z80.d=z80.d_;z80.d_=n;n=z80.e;z80.e=z80.e_;z80.e_=n;n=z80.h;z80.h=z80.h_;z80.h_=n;n=z80.l;z80.l=z80.l_;z80.l_=n},n[218]=function(){var n,t,i;tstates+=6;z80.f&1?(n=z80.pc,t=readbyte(n++),n&=65535,i=readbyte(n),z80.pc=t|i<<8):z80.pc+=2},n[219]=function(){var n;tstates+=4;n=readbyte(z80.pc++)+(z80.a<<8);z80.pc&=65535;tstates+=3;z80.a=readport(n)},n[220]=function(){var n,t,i,r;tstates+=6;z80.f&1?(n=readbyte(z80.pc++),z80.pc&=65535,tstates++,t=readbyte(z80.pc++),z80.pc&=65535,tstates+=6,z80.sp--,z80.sp&=65535,writebyte(z80.sp,z80.pc>>8),z80.sp--,z80.sp&=65535,writebyte(z80.sp,z80.pc&255),i=n,r=t,z80.pc=i|r<<8):z80.pc+=2},n[221]=function(){var n;tstates+=4;n=readbyte(z80.pc++);z80.pc&=65535;z80.r=z80.r+1&127;z80_ddxx(n)},n[222]=function(){tstates+=3;var t=readbyte(z80.pc++),n=z80.a-t-(z80.f&1),i=(z80.a&136)>>3|(t&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[i&7]|overflow_sub_table[i>>4]|sz53_table[z80.a]},n[223]=function(){tstates++;tstates+=6;z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.pc>>8);z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.pc&255);z80.pc=24},n[224]=function(){var n,t;tstates++;z80.f&4||(tstates+=6,n=readbyte(z80.sp++),z80.sp&=65535,t=readbyte(z80.sp++),z80.sp&=65535,z80.pc=n|t<<8)},n[225]=function(){tstates+=6;z80.l=readbyte(z80.sp++);z80.sp&=65535;z80.h=readbyte(z80.sp++);z80.sp&=65535},n[226]=function(){var n,t,i;tstates+=6;z80.f&4?z80.pc+=2:(n=z80.pc,t=readbyte(n++),n&=65535,i=readbyte(n),z80.pc=t|i<<8)},n[227]=function(){var n=readbyte(z80.sp),t=readbyte(z80.sp+1);tstates+=15;writebyte(z80.sp+1,z80.h);writebyte(z80.sp,z80.l);z80.l=n;z80.h=t},n[228]=function(){var n,t,i,r;tstates+=6;z80.f&4?z80.pc+=2:(n=readbyte(z80.pc++),z80.pc&=65535,tstates++,t=readbyte(z80.pc++),z80.pc&=65535,tstates+=6,z80.sp--,z80.sp&=65535,writebyte(z80.sp,z80.pc>>8),z80.sp--,z80.sp&=65535,writebyte(z80.sp,z80.pc&255),i=n,r=t,z80.pc=i|r<<8)},n[229]=function(){tstates++;tstates+=6;z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.h);z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.l)},n[230]=function(){tstates+=3;var n=readbyte(z80.pc++);z80.a&=n;z80.f=16|sz53p_table[z80.a]},n[231]=function(){tstates++;tstates+=6;z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.pc>>8);z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.pc&255);z80.pc=32},n[232]=function(){var n,t;tstates++;z80.f&4&&(tstates+=6,n=readbyte(z80.sp++),z80.sp&=65535,t=readbyte(z80.sp++),z80.sp&=65535,z80.pc=n|t<<8)},n[233]=function(){z80.pc=z80.l|z80.h<<8},n[234]=function(){var n,t,i;tstates+=6;z80.f&4?(n=z80.pc,t=readbyte(n++),n&=65535,i=readbyte(n),z80.pc=t|i<<8):z80.pc+=2},n[235]=function(){var n;n=z80.d;z80.d=z80.h;z80.h=n;n=z80.e;z80.e=z80.l;z80.l=n},n[236]=function(){var n,t,i,r;tstates+=6;z80.f&4?(n=readbyte(z80.pc++),z80.pc&=65535,tstates++,t=readbyte(z80.pc++),z80.pc&=65535,tstates+=6,z80.sp--,z80.sp&=65535,writebyte(z80.sp,z80.pc>>8),z80.sp--,z80.sp&=65535,writebyte(z80.sp,z80.pc&255),i=n,r=t,z80.pc=i|r<<8):z80.pc+=2},n[237]=function(){var n;tstates+=4;n=readbyte(z80.pc++);z80.pc&=65535;z80.r=z80.r+1&127;z80_edxx(n)},n[238]=function(){tstates+=3;var n=readbyte(z80.pc++);z80.a^=n;z80.f=sz53p_table[z80.a]},n[239]=function(){tstates++;tstates+=6;z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.pc>>8);z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.pc&255);z80.pc=40},n[240]=function(){var n,t;tstates++;z80.f&128||(tstates+=6,n=readbyte(z80.sp++),z80.sp&=65535,t=readbyte(z80.sp++),z80.sp&=65535,z80.pc=n|t<<8)},n[241]=function(){tstates+=6;z80.f=readbyte(z80.sp++);z80.sp&=65535;z80.a=readbyte(z80.sp++);z80.sp&=65535},n[242]=function(){var n,t,i;tstates+=6;z80.f&128?z80.pc+=2:(n=z80.pc,t=readbyte(n++),n&=65535,i=readbyte(n),z80.pc=t|i<<8)},n[243]=function(){z80.iff1=z80.iff2=0},n[244]=function(){var n,t,i,r;tstates+=6;z80.f&128?z80.pc+=2:(n=readbyte(z80.pc++),z80.pc&=65535,tstates++,t=readbyte(z80.pc++),z80.pc&=65535,tstates+=6,z80.sp--,z80.sp&=65535,writebyte(z80.sp,z80.pc>>8),z80.sp--,z80.sp&=65535,writebyte(z80.sp,z80.pc&255),i=n,r=t,z80.pc=i|r<<8)},n[245]=function(){tstates++;tstates+=6;z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.a);z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.f)},n[246]=function(){tstates+=3;var n=readbyte(z80.pc++);z80.a|=n;z80.f=sz53p_table[z80.a]},n[247]=function(){tstates++;tstates+=6;z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.pc>>8);z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.pc&255);z80.pc=48},n[248]=function(){var n,t;tstates++;z80.f&128&&(tstates+=6,n=readbyte(z80.sp++),z80.sp&=65535,t=readbyte(z80.sp++),z80.sp&=65535,z80.pc=n|t<<8)},n[249]=function(){tstates+=2;z80.sp=z80.l|z80.h<<8},n[250]=function(){var n,t,i;tstates+=6;z80.f&128?(n=z80.pc,t=readbyte(n++),n&=65535,i=readbyte(n),z80.pc=t|i<<8):z80.pc+=2},n[251]=function(){z80.iff1=z80.iff2=1},n[252]=function(){var n,t,i,r;tstates+=6;z80.f&128?(n=readbyte(z80.pc++),z80.pc&=65535,tstates++,t=readbyte(z80.pc++),z80.pc&=65535,tstates+=6,z80.sp--,z80.sp&=65535,writebyte(z80.sp,z80.pc>>8),z80.sp--,z80.sp&=65535,writebyte(z80.sp,z80.pc&255),i=n,r=t,z80.pc=i|r<<8):z80.pc+=2},n[253]=function(){var n;tstates+=4;n=readbyte(z80.pc++);z80.pc&=65535;z80.r=z80.r+1&127;z80_fdxx(n)},n[254]=function(){tstates+=3;var t=readbyte(z80.pc++),n=z80.a-t,i=(z80.a&136)>>3|(t&136)>>2|(n&136)>>1;z80.f=(n&256?1:n?0:64)|2|halfcarry_sub_table[i&7]|overflow_sub_table[i>>4]|t&40|n&128},n[255]=function(){tstates++;tstates+=6;z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.pc>>8);z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.pc&255);z80.pc=56},n[256]=function(){},z80_defaults(n),n}();z80_ed_ops=function(){var n=[];return n[64]=function(){tstates+=1;tstates+=3;z80.b=readport(z80.c|z80.b<<8);z80.f=z80.f&1|sz53p_table[z80.b]},n[65]=function(){tstates+=1;tstates+=3;writeport(z80.c|z80.b<<8,z80.b)},n[66]=function(){tstates+=7;var n=(z80.l|z80.h<<8)-(z80.c|z80.b<<8)-(z80.f&1),t=((z80.l|z80.h<<8)&34816)>>11|((z80.c|z80.b<<8)&34816)>>10|(n&34816)>>9;z80.h=n>>8&255;z80.l=n&255;z80.f=(n&65536?1:0)|2|overflow_sub_table[t>>4]|z80.h&168|halfcarry_sub_table[t&7]|(z80.l|z80.h<<8?0:64)},n[67]=function(){var n;tstates+=12;n=readbyte(z80.pc++);z80.pc&=65535;n|=readbyte(z80.pc++)<<8;z80.pc&=65535;writebyte(n++,z80.c);n&=65535;writebyte(n,z80.b)},n[68]=n[76]=n[84]=n[92]=n[100]=n[108]=n[116]=n[124]=function(){var i=z80.a,n,t;z80.a=0;n=z80.a-i;t=(z80.a&136)>>3|(i&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|sz53_table[z80.a]},n[69]=n[77]=n[85]=n[93]=n[101]=n[109]=n[117]=n[125]=function(){var n,t;z80.iff1=z80.iff2;tstates+=6;n=readbyte(z80.sp++);z80.sp&=65535;t=readbyte(z80.sp++);z80.sp&=65535;z80.pc=n|t<<8},n[70]=n[78]=n[102]=n[110]=function(){z80.im=0},n[71]=function(){tstates+=1;z80.i=z80.a},n[72]=function(){tstates+=1;tstates+=3;z80.c=readport(z80.c|z80.b<<8);z80.f=z80.f&1|sz53p_table[z80.c]},n[73]=function(){tstates+=1;tstates+=3;writeport(z80.c|z80.b<<8,z80.c)},n[74]=function(){tstates+=7;var n=(z80.l|z80.h<<8)+(z80.c|z80.b<<8)+(z80.f&1),t=((z80.l|z80.h<<8)&34816)>>11|((z80.c|z80.b<<8)&34816)>>10|(n&34816)>>9;z80.h=n>>8&255;z80.l=n&255;z80.f=(n&65536?1:0)|overflow_add_table[t>>4]|z80.h&168|halfcarry_add_table[t&7]|(z80.l|z80.h<<8?0:64)},n[75]=function(){var n;tstates+=12;n=readbyte(z80.pc++);z80.pc&=65535;n|=readbyte(z80.pc++)<<8;z80.pc&=65535;z80.c=readbyte(n++);n&=65535;z80.b=readbyte(n)},n[79]=function(){tstates+=1;z80.r=z80.r7=z80.a},n[80]=function(){tstates+=1;tstates+=3;z80.d=readport(z80.c|z80.b<<8);z80.f=z80.f&1|sz53p_table[z80.d]},n[81]=function(){tstates+=1;tstates+=3;writeport(z80.c|z80.b<<8,z80.d)},n[82]=function(){tstates+=7;var n=(z80.l|z80.h<<8)-(z80.e|z80.d<<8)-(z80.f&1),t=((z80.l|z80.h<<8)&34816)>>11|((z80.e|z80.d<<8)&34816)>>10|(n&34816)>>9;z80.h=n>>8&255;z80.l=n&255;z80.f=(n&65536?1:0)|2|overflow_sub_table[t>>4]|z80.h&168|halfcarry_sub_table[t&7]|(z80.l|z80.h<<8?0:64)},n[83]=function(){var n;tstates+=12;n=readbyte(z80.pc++);z80.pc&=65535;n|=readbyte(z80.pc++)<<8;z80.pc&=65535;writebyte(n++,z80.e);n&=65535;writebyte(n,z80.d)},n[86]=n[118]=function(){z80.im=1},n[87]=function(){tstates+=1;z80.a=z80.i;z80.f=z80.f&1|sz53_table[z80.a]|(z80.iff2?4:0)},n[88]=function(){tstates+=1;tstates+=3;z80.e=readport(z80.c|z80.b<<8);z80.f=z80.f&1|sz53p_table[z80.e]},n[89]=function(){tstates+=1;tstates+=3;writeport(z80.c|z80.b<<8,z80.e)},n[90]=function(){tstates+=7;var n=(z80.l|z80.h<<8)+(z80.e|z80.d<<8)+(z80.f&1),t=((z80.l|z80.h<<8)&34816)>>11|((z80.e|z80.d<<8)&34816)>>10|(n&34816)>>9;z80.h=n>>8&255;z80.l=n&255;z80.f=(n&65536?1:0)|overflow_add_table[t>>4]|z80.h&168|halfcarry_add_table[t&7]|(z80.l|z80.h<<8?0:64)},n[91]=function(){var n;tstates+=12;n=readbyte(z80.pc++);z80.pc&=65535;n|=readbyte(z80.pc++)<<8;z80.pc&=65535;z80.e=readbyte(n++);n&=65535;z80.d=readbyte(n)},n[94]=n[126]=function(){z80.im=2},n[95]=function(){tstates+=1;z80.a=z80.r&127|z80.r7&128;z80.f=z80.f&1|sz53_table[z80.a]|(z80.iff2?4:0)},n[96]=function(){tstates+=1;tstates+=3;z80.h=readport(z80.c|z80.b<<8);z80.f=z80.f&1|sz53p_table[z80.h]},n[97]=function(){tstates+=1;tstates+=3;writeport(z80.c|z80.b<<8,z80.h)},n[98]=function(){tstates+=7;var n=(z80.l|z80.h<<8)-(z80.l|z80.h<<8)-(z80.f&1),t=((z80.l|z80.h<<8)&34816)>>11|((z80.l|z80.h<<8)&34816)>>10|(n&34816)>>9;z80.h=n>>8&255;z80.l=n&255;z80.f=(n&65536?1:0)|2|overflow_sub_table[t>>4]|z80.h&168|halfcarry_sub_table[t&7]|(z80.l|z80.h<<8?0:64)},n[99]=function(){var n;tstates+=12;n=readbyte(z80.pc++);z80.pc&=65535;n|=readbyte(z80.pc++)<<8;z80.pc&=65535;writebyte(n++,z80.l);n&=65535;writebyte(n,z80.h)},n[103]=function(){var n=readbyte(z80.l|z80.h<<8);tstates+=10;writebyte(z80.l|z80.h<<8,(z80.a&15)<<4|n>>4);z80.a=z80.a&240|n&15;z80.f=z80.f&1|sz53p_table[z80.a]},n[104]=function(){tstates+=1;tstates+=3;z80.l=readport(z80.c|z80.b<<8);z80.f=z80.f&1|sz53p_table[z80.l]},n[105]=function(){tstates+=1;tstates+=3;writeport(z80.c|z80.b<<8,z80.l)},n[106]=function(){tstates+=7;var n=(z80.l|z80.h<<8)+(z80.l|z80.h<<8)+(z80.f&1),t=((z80.l|z80.h<<8)&34816)>>11|((z80.l|z80.h<<8)&34816)>>10|(n&34816)>>9;z80.h=n>>8&255;z80.l=n&255;z80.f=(n&65536?1:0)|overflow_add_table[t>>4]|z80.h&168|halfcarry_add_table[t&7]|(z80.l|z80.h<<8?0:64)},n[107]=function(){var n;tstates+=12;n=readbyte(z80.pc++);z80.pc&=65535;n|=readbyte(z80.pc++)<<8;z80.pc&=65535;z80.l=readbyte(n++);n&=65535;z80.h=readbyte(n)},n[111]=function(){var n=readbyte(z80.l|z80.h<<8);tstates+=10;writebyte(z80.l|z80.h<<8,(n&15)<<4|z80.a&15);z80.a=z80.a&240|n>>4;z80.f=z80.f&1|sz53p_table[z80.a]},n[112]=function(){tstates+=1;var n;tstates+=3;n=readport(z80.c|z80.b<<8);z80.f=z80.f&1|sz53p_table[n]},n[113]=function(){tstates+=1;tstates+=3;writeport(z80.c|z80.b<<8,0)},n[114]=function(){tstates+=7;var n=(z80.l|z80.h<<8)-z80.sp-(z80.f&1),t=((z80.l|z80.h<<8)&34816)>>11|(z80.sp&34816)>>10|(n&34816)>>9;z80.h=n>>8&255;z80.l=n&255;z80.f=(n&65536?1:0)|2|overflow_sub_table[t>>4]|z80.h&168|halfcarry_sub_table[t&7]|(z80.l|z80.h<<8?0:64)},n[115]=function(){var n;tstates+=12;n=readbyte(z80.pc++);z80.pc&=65535;n|=readbyte(z80.pc++)<<8;z80.pc&=65535;writebyte(n++,z80.sp&255);n&=65535;writebyte(n,z80.sp>>8)},n[120]=function(){tstates+=1;tstates+=3;z80.a=readport(z80.c|z80.b<<8);z80.f=z80.f&1|sz53p_table[z80.a]},n[121]=function(){tstates+=1;tstates+=3;writeport(z80.c|z80.b<<8,z80.a)},n[122]=function(){tstates+=7;var n=(z80.l|z80.h<<8)+z80.sp+(z80.f&1),t=((z80.l|z80.h<<8)&34816)>>11|(z80.sp&34816)>>10|(n&34816)>>9;z80.h=n>>8&255;z80.l=n&255;z80.f=(n&65536?1:0)|overflow_add_table[t>>4]|z80.h&168|halfcarry_add_table[t&7]|(z80.l|z80.h<<8?0:64)},n[123]=function(){var n,t,i;tstates+=12;n=readbyte(z80.pc++);z80.pc&=65535;n|=readbyte(z80.pc++)<<8;z80.pc&=65535;t=readbyte(n++);n&=65535;i=readbyte(n);z80.sp=t|i<<8},n[160]=function(){var n=readbyte(z80.l|z80.h<<8),t,i,r;tstates+=8;t=(z80.c|z80.b<<8)-1&65535;z80.b=t>>8;z80.c=t&255;writebyte(z80.e|z80.d<<8,n);i=(z80.e|z80.d<<8)+1&65535;z80.d=i>>8;z80.e=i&255;r=(z80.l|z80.h<<8)+1&65535;z80.h=r>>8;z80.l=r&255;n=n+z80.a&255;z80.f=z80.f&193|(z80.c|z80.b<<8?4:0)|n&8|(n&2?32:0)},n[161]=function(){var r=readbyte(z80.l|z80.h<<8),n=z80.a-r&255,u=(z80.a&8)>>3|(r&8)>>2|(n&8)>>1,t,i;tstates+=8;t=(z80.l|z80.h<<8)+1&65535;z80.h=t>>8;z80.l=t&255;i=(z80.c|z80.b<<8)-1&65535;z80.b=i>>8;z80.c=i&255;z80.f=z80.f&1|(z80.c|z80.b<<8?6:2)|halfcarry_sub_table[u]|(n?0:64)|n&128;z80.f&16&&n--;z80.f|=n&8|(n&2?32:0)},n[162]=function(){var t=readport(z80.c|z80.b<<8),n;tstates+=5;tstates+=3;writebyte(z80.l|z80.h<<8,t);z80.b=z80.b-1&255;n=(z80.l|z80.h<<8)+1&65535;z80.h=n>>8;z80.l=n&255;z80.f=(t&128?2:0)|sz53_table[z80.b]},n[163]=function(){var t=readbyte(z80.l|z80.h<<8),n;z80.b=z80.b-1&255;tstates+=5;tstates+=3;n=(z80.l|z80.h<<8)+1&65535;z80.h=n>>8;z80.l=n&255;writeport(z80.c|z80.b<<8,t);z80.f=(t&128?2:0)|sz53_table[z80.b]},n[168]=function(){var n=readbyte(z80.l|z80.h<<8),t,i,r;tstates+=8;t=(z80.c|z80.b<<8)-1&65535;z80.b=t>>8;z80.c=t&255;writebyte(z80.e|z80.d<<8,n);i=(z80.e|z80.d<<8)-1&65535;z80.d=i>>8;z80.e=i&255;r=(z80.l|z80.h<<8)-1&65535;z80.h=r>>8;z80.l=r&255;n=n+z80.a&255;z80.f=z80.f&193|(z80.c|z80.b<<8?4:0)|n&8|(n&2?32:0)},n[169]=function(){var r=readbyte(z80.l|z80.h<<8),n=z80.a-r&255,u=(z80.a&8)>>3|(r&8)>>2|(n&8)>>1,t,i;tstates+=8;t=(z80.l|z80.h<<8)-1&65535;z80.h=t>>8;z80.l=t&255;i=(z80.c|z80.b<<8)-1&65535;z80.b=i>>8;z80.c=i&255;z80.f=z80.f&1|(z80.c|z80.b<<8?6:2)|halfcarry_sub_table[u]|(n?0:64)|n&128;z80.f&16&&n--;z80.f|=n&8|(n&2?32:0)},n[170]=function(){var t=readport(z80.c|z80.b<<8),n;tstates+=5;tstates+=3;writebyte(z80.l|z80.h<<8,t);z80.b=z80.b-1&255;n=(z80.l|z80.h<<8)-1&65535;z80.h=n>>8;z80.l=n&255;z80.f=(t&128?2:0)|sz53_table[z80.b]},n[171]=function(){var t=readbyte(z80.l|z80.h<<8),n;z80.b=z80.b-1&255;tstates+=5;tstates+=3;n=(z80.l|z80.h<<8)-1&65535;z80.h=n>>8;z80.l=n&255;writeport(z80.c|z80.b<<8,t);z80.f=(t&128?2:0)|sz53_table[z80.b]},n[176]=function(){var n=readbyte(z80.l|z80.h<<8),t,i,r;tstates+=8;writebyte(z80.e|z80.d<<8,n);t=(z80.l|z80.h<<8)+1&65535;z80.h=t>>8;z80.l=t&255;i=(z80.e|z80.d<<8)+1&65535;z80.d=i>>8;z80.e=i&255;r=(z80.c|z80.b<<8)-1&65535;z80.b=r>>8;z80.c=r&255;n=n+z80.a&255;z80.f=z80.f&193|(z80.c|z80.b<<8?4:0)|n&8|(n&2?32:0);z80.c|z80.b<<8&&(tstates+=5,z80.pc-=2)},n[177]=function(){var r=readbyte(z80.l|z80.h<<8),n=z80.a-r&255,u=(z80.a&8)>>3|(r&8)>>2|(n&8)>>1,t,i;tstates+=8;t=(z80.l|z80.h<<8)+1&65535;z80.h=t>>8;z80.l=t&255;i=(z80.c|z80.b<<8)-1&65535;z80.b=i>>8;z80.c=i&255;z80.f=z80.f&1|(z80.c|z80.b<<8?6:2)|halfcarry_sub_table[u]|(n?0:64)|n&128;z80.f&16&&n--;z80.f|=n&8|(n&2?32:0);(z80.f&68)==4&&(tstates+=5,z80.pc-=2)},n[178]=function(){var t=readport(z80.c|z80.b<<8),n;tstates+=5;tstates+=3;writebyte(z80.l|z80.h<<8,t);z80.b=z80.b-1&255;n=(z80.l|z80.h<<8)+1&65535;z80.h=n>>8;z80.l=n&255;z80.f=(t&128?2:0)|sz53_table[z80.b];z80.b&&(tstates+=5,z80.pc-=2)},n[179]=function(){var t=readbyte(z80.l|z80.h<<8),n;tstates+=5;z80.b=z80.b-1&255;n=(z80.l|z80.h<<8)+1&65535;z80.h=n>>8;z80.l=n&255;writeport(z80.c|z80.b<<8,t);z80.f=(t&128?2:0)|sz53_table[z80.b];z80.b?(tstates+=1,tstates+=7,z80.pc-=2):tstates+=3},n[184]=function(){var n=readbyte(z80.l|z80.h<<8),t,i,r;tstates+=8;writebyte(z80.e|z80.d<<8,n);t=(z80.l|z80.h<<8)-1&65535;z80.h=t>>8;z80.l=t&255;i=(z80.e|z80.d<<8)-1&65535;z80.d=i>>8;z80.e=i&255;r=(z80.c|z80.b<<8)-1&65535;z80.b=r>>8;z80.c=r&255;n=n+z80.a&255;z80.f=z80.f&193|(z80.c|z80.b<<8?4:0)|n&8|(n&2?32:0);z80.c|z80.b<<8&&(tstates+=5,z80.pc-=2)},n[185]=function(){var r=readbyte(z80.l|z80.h<<8),n=z80.a-r&255,u=(z80.a&8)>>3|(r&8)>>2|(n&8)>>1,t,i;tstates+=8;t=(z80.l|z80.h<<8)-1&65535;z80.h=t>>8;z80.l=t&255;i=(z80.c|z80.b<<8)-1&65535;z80.b=i>>8;z80.c=i&255;z80.f=z80.f&1|(z80.c|z80.b<<8?6:2)|halfcarry_sub_table[u]|(n?0:64)|n&128;z80.f&16&&n--;z80.f|=n&8|(n&2?32:0);(z80.f&68)==4&&(tstates+=5,z80.pc-=2)},n[186]=function(){var t=readport(z80.c|z80.b<<8),n;tstates+=5;tstates+=3;writebyte(z80.l|z80.h<<8,t);z80.b=z80.b-1&255;n=(z80.l|z80.h<<8)-1&65535;z80.h=n>>8;z80.l=n&255;z80.f=(t&128?2:0)|sz53_table[z80.b];z80.b&&(tstates+=5,z80.pc-=2)},n[187]=function(){var t=readbyte(z80.l|z80.h<<8),n;tstates+=5;z80.b=z80.b-1&255;n=(z80.l|z80.h<<8)-1&65535;z80.h=n>>8;z80.l=n&255;writeport(z80.c|z80.b<<8,t);z80.f=(t&128?2:0)|sz53_table[z80.b];z80.b?(tstates+=1,tstates+=7,z80.pc-=2):tstates+=3},n[256]=function(){},z80_defaults(n),n}();z80_cb_ops=function(){var n=[];return n[0]=function(){z80.b=(z80.b&127)<<1|z80.b>>7;z80.f=z80.b&1|sz53p_table[z80.b]},n[1]=function(){z80.c=(z80.c&127)<<1|z80.c>>7;z80.f=z80.c&1|sz53p_table[z80.c]},n[2]=function(){z80.d=(z80.d&127)<<1|z80.d>>7;z80.f=z80.d&1|sz53p_table[z80.d]},n[3]=function(){z80.e=(z80.e&127)<<1|z80.e>>7;z80.f=z80.e&1|sz53p_table[z80.e]},n[4]=function(){z80.h=(z80.h&127)<<1|z80.h>>7;z80.f=z80.h&1|sz53p_table[z80.h]},n[5]=function(){z80.l=(z80.l&127)<<1|z80.l>>7;z80.f=z80.l&1|sz53p_table[z80.l]},n[6]=function(){var n=readbyte(z80.l|z80.h<<8);tstates+=7;n=(n&127)<<1|n>>7;z80.f=n&1|sz53p_table[n];writebyte(z80.l|z80.h<<8,n)},n[7]=function(){z80.a=(z80.a&127)<<1|z80.a>>7;z80.f=z80.a&1|sz53p_table[z80.a]},n[8]=function(){z80.f=z80.b&1;z80.b=z80.b>>1|(z80.b&1)<<7;z80.f|=sz53p_table[z80.b]},n[9]=function(){z80.f=z80.c&1;z80.c=z80.c>>1|(z80.c&1)<<7;z80.f|=sz53p_table[z80.c]},n[10]=function(){z80.f=z80.d&1;z80.d=z80.d>>1|(z80.d&1)<<7;z80.f|=sz53p_table[z80.d]},n[11]=function(){z80.f=z80.e&1;z80.e=z80.e>>1|(z80.e&1)<<7;z80.f|=sz53p_table[z80.e]},n[12]=function(){z80.f=z80.h&1;z80.h=z80.h>>1|(z80.h&1)<<7;z80.f|=sz53p_table[z80.h]},n[13]=function(){z80.f=z80.l&1;z80.l=z80.l>>1|(z80.l&1)<<7;z80.f|=sz53p_table[z80.l]},n[14]=function(){var n=readbyte(z80.l|z80.h<<8);tstates+=7;z80.f=n&1;n=n>>1|(n&1)<<7;z80.f|=sz53p_table[n];writebyte(z80.l|z80.h<<8,n)},n[15]=function(){z80.f=z80.a&1;z80.a=z80.a>>1|(z80.a&1)<<7;z80.f|=sz53p_table[z80.a]},n[16]=function(){var n=z80.b;z80.b=(z80.b&127)<<1|z80.f&1;z80.f=n>>7|sz53p_table[z80.b]},n[17]=function(){var n=z80.c;z80.c=(z80.c&127)<<1|z80.f&1;z80.f=n>>7|sz53p_table[z80.c]},n[18]=function(){var n=z80.d;z80.d=(z80.d&127)<<1|z80.f&1;z80.f=n>>7|sz53p_table[z80.d]},n[19]=function(){var n=z80.e;z80.e=(z80.e&127)<<1|z80.f&1;z80.f=n>>7|sz53p_table[z80.e]},n[20]=function(){var n=z80.h;z80.h=(z80.h&127)<<1|z80.f&1;z80.f=n>>7|sz53p_table[z80.h]},n[21]=function(){var n=z80.l;z80.l=(z80.l&127)<<1|z80.f&1;z80.f=n>>7|sz53p_table[z80.l]},n[22]=function(){var n=readbyte(z80.l|z80.h<<8),t;tstates+=7;t=n;n=(n&127)<<1|z80.f&1;z80.f=t>>7|sz53p_table[n];writebyte(z80.l|z80.h<<8,n)},n[23]=function(){var n=z80.a;z80.a=(z80.a&127)<<1|z80.f&1;z80.f=n>>7|sz53p_table[z80.a]},n[24]=function(){var n=z80.b;z80.b=z80.b>>1|(z80.f&1)<<7;z80.f=n&1|sz53p_table[z80.b]},n[25]=function(){var n=z80.c;z80.c=z80.c>>1|(z80.f&1)<<7;z80.f=n&1|sz53p_table[z80.c]},n[26]=function(){var n=z80.d;z80.d=z80.d>>1|(z80.f&1)<<7;z80.f=n&1|sz53p_table[z80.d]},n[27]=function(){var n=z80.e;z80.e=z80.e>>1|(z80.f&1)<<7;z80.f=n&1|sz53p_table[z80.e]},n[28]=function(){var n=z80.h;z80.h=z80.h>>1|(z80.f&1)<<7;z80.f=n&1|sz53p_table[z80.h]},n[29]=function(){var n=z80.l;z80.l=z80.l>>1|(z80.f&1)<<7;z80.f=n&1|sz53p_table[z80.l]},n[30]=function(){var n=readbyte(z80.l|z80.h<<8),t;tstates+=7;t=n;n=n>>1|(z80.f&1)<<7;z80.f=t&1|sz53p_table[n];writebyte(z80.l|z80.h<<8,n)},n[31]=function(){var n=z80.a;z80.a=z80.a>>1|(z80.f&1)<<7;z80.f=n&1|sz53p_table[z80.a]},n[32]=function(){z80.f=z80.b>>7;z80.b<<=1;z80.b&=255;z80.f|=sz53p_table[z80.b]},n[33]=function(){z80.f=z80.c>>7;z80.c<<=1;z80.c&=255;z80.f|=sz53p_table[z80.c]},n[34]=function(){z80.f=z80.d>>7;z80.d<<=1;z80.d&=255;z80.f|=sz53p_table[z80.d]},n[35]=function(){z80.f=z80.e>>7;z80.e<<=1;z80.e&=255;z80.f|=sz53p_table[z80.e]},n[36]=function(){z80.f=z80.h>>7;z80.h<<=1;z80.h&=255;z80.f|=sz53p_table[z80.h]},n[37]=function(){z80.f=z80.l>>7;z80.l<<=1;z80.l&=255;z80.f|=sz53p_table[z80.l]},n[38]=function(){var n=readbyte(z80.l|z80.h<<8);tstates+=7;z80.f=n>>7;n<<=1;n&=255;z80.f|=sz53p_table[n];writebyte(z80.l|z80.h<<8,n)},n[39]=function(){z80.f=z80.a>>7;z80.a<<=1;z80.a&=255;z80.f|=sz53p_table[z80.a]},n[40]=function(){z80.f=z80.b&1;z80.b=z80.b&128|z80.b>>1;z80.f|=sz53p_table[z80.b]},n[41]=function(){z80.f=z80.c&1;z80.c=z80.c&128|z80.c>>1;z80.f|=sz53p_table[z80.c]},n[42]=function(){z80.f=z80.d&1;z80.d=z80.d&128|z80.d>>1;z80.f|=sz53p_table[z80.d]},n[43]=function(){z80.f=z80.e&1;z80.e=z80.e&128|z80.e>>1;z80.f|=sz53p_table[z80.e]},n[44]=function(){z80.f=z80.h&1;z80.h=z80.h&128|z80.h>>1;z80.f|=sz53p_table[z80.h]},n[45]=function(){z80.f=z80.l&1;z80.l=z80.l&128|z80.l>>1;z80.f|=sz53p_table[z80.l]},n[46]=function(){var n=readbyte(z80.l|z80.h<<8);tstates+=7;z80.f=n&1;n=n&128|n>>1;z80.f|=sz53p_table[n];writebyte(z80.l|z80.h<<8,n)},n[47]=function(){z80.f=z80.a&1;z80.a=z80.a&128|z80.a>>1;z80.f|=sz53p_table[z80.a]},n[48]=function(){z80.f=z80.b>>7;z80.b=z80.b<<1|1;z80.b&=255;z80.f|=sz53p_table[z80.b]},n[49]=function(){z80.f=z80.c>>7;z80.c=z80.c<<1|1;z80.c&=255;z80.f|=sz53p_table[z80.c]},n[50]=function(){z80.f=z80.d>>7;z80.d=z80.d<<1|1;z80.d&=255;z80.f|=sz53p_table[z80.d]},n[51]=function(){z80.f=z80.e>>7;z80.e=z80.e<<1|1;z80.e&=255;z80.f|=sz53p_table[z80.e]},n[52]=function(){z80.f=z80.h>>7;z80.h=z80.h<<1|1;z80.h&=255;z80.f|=sz53p_table[z80.h]},n[53]=function(){z80.f=z80.l>>7;z80.l=z80.l<<1|1;z80.l&=255;z80.f|=sz53p_table[z80.l]},n[54]=function(){var n=readbyte(z80.l|z80.h<<8);tstates+=7;z80.f=n>>7;n=n<<1|1;n&=255;z80.f|=sz53p_table[n];writebyte(z80.l|z80.h<<8,n)},n[55]=function(){z80.f=z80.a>>7;z80.a=z80.a<<1|1;z80.a&=255;z80.f|=sz53p_table[z80.a]},n[56]=function(){z80.f=z80.b&1;z80.b>>=1;z80.f|=sz53p_table[z80.b]},n[57]=function(){z80.f=z80.c&1;z80.c>>=1;z80.f|=sz53p_table[z80.c]},n[58]=function(){z80.f=z80.d&1;z80.d>>=1;z80.f|=sz53p_table[z80.d]},n[59]=function(){z80.f=z80.e&1;z80.e>>=1;z80.f|=sz53p_table[z80.e]},n[60]=function(){z80.f=z80.h&1;z80.h>>=1;z80.f|=sz53p_table[z80.h]},n[61]=function(){z80.f=z80.l&1;z80.l>>=1;z80.f|=sz53p_table[z80.l]},n[62]=function(){var n=readbyte(z80.l|z80.h<<8);tstates+=7;z80.f=n&1;n>>=1;z80.f|=sz53p_table[n];writebyte(z80.l|z80.h<<8,n)},n[63]=function(){z80.f=z80.a&1;z80.a>>=1;z80.f|=sz53p_table[z80.a]},n[64]=function(){z80.f=z80.f&1|16|z80.b&40;z80.b&1||(z80.f|=68);!1&&z80.b&128&&(z80.f|=128)},n[65]=function(){z80.f=z80.f&1|16|z80.c&40;z80.c&1||(z80.f|=68);!1&&z80.c&128&&(z80.f|=128)},n[66]=function(){z80.f=z80.f&1|16|z80.d&40;z80.d&1||(z80.f|=68);!1&&z80.d&128&&(z80.f|=128)},n[67]=function(){z80.f=z80.f&1|16|z80.e&40;z80.e&1||(z80.f|=68);!1&&z80.e&128&&(z80.f|=128)},n[68]=function(){z80.f=z80.f&1|16|z80.h&40;z80.h&1||(z80.f|=68);!1&&z80.h&128&&(z80.f|=128)},n[69]=function(){z80.f=z80.f&1|16|z80.l&40;z80.l&1||(z80.f|=68);!1&&z80.l&128&&(z80.f|=128)},n[70]=function(){var n=readbyte(z80.l|z80.h<<8);tstates+=4;z80.f=z80.f&1|16|n&40;n&1||(z80.f|=68);!1&&n&128&&(z80.f|=128)},n[71]=function(){z80.f=z80.f&1|16|z80.a&40;z80.a&1||(z80.f|=68);!1&&z80.a&128&&(z80.f|=128)},n[72]=function(){z80.f=z80.f&1|16|z80.b&40;z80.b&2||(z80.f|=68);!1&&z80.b&128&&(z80.f|=128)},n[73]=function(){z80.f=z80.f&1|16|z80.c&40;z80.c&2||(z80.f|=68);!1&&z80.c&128&&(z80.f|=128)},n[74]=function(){z80.f=z80.f&1|16|z80.d&40;z80.d&2||(z80.f|=68);!1&&z80.d&128&&(z80.f|=128)},n[75]=function(){z80.f=z80.f&1|16|z80.e&40;z80.e&2||(z80.f|=68);!1&&z80.e&128&&(z80.f|=128)},n[76]=function(){z80.f=z80.f&1|16|z80.h&40;z80.h&2||(z80.f|=68);!1&&z80.h&128&&(z80.f|=128)},n[77]=function(){z80.f=z80.f&1|16|z80.l&40;z80.l&2||(z80.f|=68);!1&&z80.l&128&&(z80.f|=128)},n[78]=function(){var n=readbyte(z80.l|z80.h<<8);tstates+=4;z80.f=z80.f&1|16|n&40;n&2||(z80.f|=68);!1&&n&128&&(z80.f|=128)},n[79]=function(){z80.f=z80.f&1|16|z80.a&40;z80.a&2||(z80.f|=68);!1&&z80.a&128&&(z80.f|=128)},n[80]=function(){z80.f=z80.f&1|16|z80.b&40;z80.b&4||(z80.f|=68);!1&&z80.b&128&&(z80.f|=128)},n[81]=function(){z80.f=z80.f&1|16|z80.c&40;z80.c&4||(z80.f|=68);!1&&z80.c&128&&(z80.f|=128)},n[82]=function(){z80.f=z80.f&1|16|z80.d&40;z80.d&4||(z80.f|=68);!1&&z80.d&128&&(z80.f|=128)},n[83]=function(){z80.f=z80.f&1|16|z80.e&40;z80.e&4||(z80.f|=68);!1&&z80.e&128&&(z80.f|=128)},n[84]=function(){z80.f=z80.f&1|16|z80.h&40;z80.h&4||(z80.f|=68);!1&&z80.h&128&&(z80.f|=128)},n[85]=function(){z80.f=z80.f&1|16|z80.l&40;z80.l&4||(z80.f|=68);!1&&z80.l&128&&(z80.f|=128)},n[86]=function(){var n=readbyte(z80.l|z80.h<<8);tstates+=4;z80.f=z80.f&1|16|n&40;n&4||(z80.f|=68);!1&&n&128&&(z80.f|=128)},n[87]=function(){z80.f=z80.f&1|16|z80.a&40;z80.a&4||(z80.f|=68);!1&&z80.a&128&&(z80.f|=128)},n[88]=function(){z80.f=z80.f&1|16|z80.b&40;z80.b&8||(z80.f|=68);!1&&z80.b&128&&(z80.f|=128)},n[89]=function(){z80.f=z80.f&1|16|z80.c&40;z80.c&8||(z80.f|=68);!1&&z80.c&128&&(z80.f|=128)},n[90]=function(){z80.f=z80.f&1|16|z80.d&40;z80.d&8||(z80.f|=68);!1&&z80.d&128&&(z80.f|=128)},n[91]=function(){z80.f=z80.f&1|16|z80.e&40;z80.e&8||(z80.f|=68);!1&&z80.e&128&&(z80.f|=128)},n[92]=function(){z80.f=z80.f&1|16|z80.h&40;z80.h&8||(z80.f|=68);!1&&z80.h&128&&(z80.f|=128)},n[93]=function(){z80.f=z80.f&1|16|z80.l&40;z80.l&8||(z80.f|=68);!1&&z80.l&128&&(z80.f|=128)},n[94]=function(){var n=readbyte(z80.l|z80.h<<8);tstates+=4;z80.f=z80.f&1|16|n&40;n&8||(z80.f|=68);!1&&n&128&&(z80.f|=128)},n[95]=function(){z80.f=z80.f&1|16|z80.a&40;z80.a&8||(z80.f|=68);!1&&z80.a&128&&(z80.f|=128)},n[96]=function(){z80.f=z80.f&1|16|z80.b&40;z80.b&16||(z80.f|=68);!1&&z80.b&128&&(z80.f|=128)},n[97]=function(){z80.f=z80.f&1|16|z80.c&40;z80.c&16||(z80.f|=68);!1&&z80.c&128&&(z80.f|=128)},n[98]=function(){z80.f=z80.f&1|16|z80.d&40;z80.d&16||(z80.f|=68);!1&&z80.d&128&&(z80.f|=128)},n[99]=function(){z80.f=z80.f&1|16|z80.e&40;z80.e&16||(z80.f|=68);!1&&z80.e&128&&(z80.f|=128)},n[100]=function(){z80.f=z80.f&1|16|z80.h&40;z80.h&16||(z80.f|=68);!1&&z80.h&128&&(z80.f|=128)},n[101]=function(){z80.f=z80.f&1|16|z80.l&40;z80.l&16||(z80.f|=68);!1&&z80.l&128&&(z80.f|=128)},n[102]=function(){var n=readbyte(z80.l|z80.h<<8);tstates+=4;z80.f=z80.f&1|16|n&40;n&16||(z80.f|=68);!1&&n&128&&(z80.f|=128)},n[103]=function(){z80.f=z80.f&1|16|z80.a&40;z80.a&16||(z80.f|=68);!1&&z80.a&128&&(z80.f|=128)},n[104]=function(){z80.f=z80.f&1|16|z80.b&40;z80.b&32||(z80.f|=68);!1&&z80.b&128&&(z80.f|=128)},n[105]=function(){z80.f=z80.f&1|16|z80.c&40;z80.c&32||(z80.f|=68);!1&&z80.c&128&&(z80.f|=128)},n[106]=function(){z80.f=z80.f&1|16|z80.d&40;z80.d&32||(z80.f|=68);!1&&z80.d&128&&(z80.f|=128)},n[107]=function(){z80.f=z80.f&1|16|z80.e&40;z80.e&32||(z80.f|=68);!1&&z80.e&128&&(z80.f|=128)},n[108]=function(){z80.f=z80.f&1|16|z80.h&40;z80.h&32||(z80.f|=68);!1&&z80.h&128&&(z80.f|=128)},n[109]=function(){z80.f=z80.f&1|16|z80.l&40;z80.l&32||(z80.f|=68);!1&&z80.l&128&&(z80.f|=128)},n[110]=function(){var n=readbyte(z80.l|z80.h<<8);tstates+=4;z80.f=z80.f&1|16|n&40;n&32||(z80.f|=68);!1&&n&128&&(z80.f|=128)},n[111]=function(){z80.f=z80.f&1|16|z80.a&40;z80.a&32||(z80.f|=68);!1&&z80.a&128&&(z80.f|=128)},n[112]=function(){z80.f=z80.f&1|16|z80.b&40;z80.b&64||(z80.f|=68);!1&&z80.b&128&&(z80.f|=128)},n[113]=function(){z80.f=z80.f&1|16|z80.c&40;z80.c&64||(z80.f|=68);!1&&z80.c&128&&(z80.f|=128)},n[114]=function(){z80.f=z80.f&1|16|z80.d&40;z80.d&64||(z80.f|=68);!1&&z80.d&128&&(z80.f|=128)},n[115]=function(){z80.f=z80.f&1|16|z80.e&40;z80.e&64||(z80.f|=68);!1&&z80.e&128&&(z80.f|=128)},n[116]=function(){z80.f=z80.f&1|16|z80.h&40;z80.h&64||(z80.f|=68);!1&&z80.h&128&&(z80.f|=128)},n[117]=function(){z80.f=z80.f&1|16|z80.l&40;z80.l&64||(z80.f|=68);!1&&z80.l&128&&(z80.f|=128)},n[118]=function(){var n=readbyte(z80.l|z80.h<<8);tstates+=4;z80.f=z80.f&1|16|n&40;n&64||(z80.f|=68);!1&&n&128&&(z80.f|=128)},n[119]=function(){z80.f=z80.f&1|16|z80.a&40;z80.a&64||(z80.f|=68);!1&&z80.a&128&&(z80.f|=128)},n[120]=function(){z80.f=z80.f&1|16|z80.b&40;z80.b&128||(z80.f|=68);!0&&z80.b&128&&(z80.f|=128)},n[121]=function(){z80.f=z80.f&1|16|z80.c&40;z80.c&128||(z80.f|=68);!0&&z80.c&128&&(z80.f|=128)},n[122]=function(){z80.f=z80.f&1|16|z80.d&40;z80.d&128||(z80.f|=68);!0&&z80.d&128&&(z80.f|=128)},n[123]=function(){z80.f=z80.f&1|16|z80.e&40;z80.e&128||(z80.f|=68);!0&&z80.e&128&&(z80.f|=128)},n[124]=function(){z80.f=z80.f&1|16|z80.h&40;z80.h&128||(z80.f|=68);!0&&z80.h&128&&(z80.f|=128)},n[125]=function(){z80.f=z80.f&1|16|z80.l&40;z80.l&128||(z80.f|=68);!0&&z80.l&128&&(z80.f|=128)},n[126]=function(){var n=readbyte(z80.l|z80.h<<8);tstates+=4;z80.f=z80.f&1|16|n&40;n&128||(z80.f|=68);!0&&n&128&&(z80.f|=128)},n[127]=function(){z80.f=z80.f&1|16|z80.a&40;z80.a&128||(z80.f|=68);!0&&z80.a&128&&(z80.f|=128)},n[128]=function(){z80.b&=254},n[129]=function(){z80.c&=254},n[130]=function(){z80.d&=254},n[131]=function(){z80.e&=254},n[132]=function(){z80.h&=254},n[133]=function(){z80.l&=254},n[134]=function(){tstates+=7;writebyte(z80.l|z80.h<<8,readbyte(z80.l|z80.h<<8)&254)},n[135]=function(){z80.a&=254},n[136]=function(){z80.b&=253},n[137]=function(){z80.c&=253},n[138]=function(){z80.d&=253},n[139]=function(){z80.e&=253},n[140]=function(){z80.h&=253},n[141]=function(){z80.l&=253},n[142]=function(){tstates+=7;writebyte(z80.l|z80.h<<8,readbyte(z80.l|z80.h<<8)&253)},n[143]=function(){z80.a&=253},n[144]=function(){z80.b&=251},n[145]=function(){z80.c&=251},n[146]=function(){z80.d&=251},n[147]=function(){z80.e&=251},n[148]=function(){z80.h&=251},n[149]=function(){z80.l&=251},n[150]=function(){tstates+=7;writebyte(z80.l|z80.h<<8,readbyte(z80.l|z80.h<<8)&251)},n[151]=function(){z80.a&=251},n[152]=function(){z80.b&=247},n[153]=function(){z80.c&=247},n[154]=function(){z80.d&=247},n[155]=function(){z80.e&=247},n[156]=function(){z80.h&=247},n[157]=function(){z80.l&=247},n[158]=function(){tstates+=7;writebyte(z80.l|z80.h<<8,readbyte(z80.l|z80.h<<8)&247)},n[159]=function(){z80.a&=247},n[160]=function(){z80.b&=239},n[161]=function(){z80.c&=239},n[162]=function(){z80.d&=239},n[163]=function(){z80.e&=239},n[164]=function(){z80.h&=239},n[165]=function(){z80.l&=239},n[166]=function(){tstates+=7;writebyte(z80.l|z80.h<<8,readbyte(z80.l|z80.h<<8)&239)},n[167]=function(){z80.a&=239},n[168]=function(){z80.b&=223},n[169]=function(){z80.c&=223},n[170]=function(){z80.d&=223},n[171]=function(){z80.e&=223},n[172]=function(){z80.h&=223},n[173]=function(){z80.l&=223},n[174]=function(){tstates+=7;writebyte(z80.l|z80.h<<8,readbyte(z80.l|z80.h<<8)&223)},n[175]=function(){z80.a&=223},n[176]=function(){z80.b&=191},n[177]=function(){z80.c&=191},n[178]=function(){z80.d&=191},n[179]=function(){z80.e&=191},n[180]=function(){z80.h&=191},n[181]=function(){z80.l&=191},n[182]=function(){tstates+=7;writebyte(z80.l|z80.h<<8,readbyte(z80.l|z80.h<<8)&191)},n[183]=function(){z80.a&=191},n[184]=function(){z80.b&=127},n[185]=function(){z80.c&=127},n[186]=function(){z80.d&=127},n[187]=function(){z80.e&=127},n[188]=function(){z80.h&=127},n[189]=function(){z80.l&=127},n[190]=function(){tstates+=7;writebyte(z80.l|z80.h<<8,readbyte(z80.l|z80.h<<8)&127)},n[191]=function(){z80.a&=127},n[192]=function(){z80.b|=1},n[193]=function(){z80.c|=1},n[194]=function(){z80.d|=1},n[195]=function(){z80.e|=1},n[196]=function(){z80.h|=1},n[197]=function(){z80.l|=1},n[198]=function(){tstates+=7;writebyte(z80.l|z80.h<<8,readbyte(z80.l|z80.h<<8)|1)},n[199]=function(){z80.a|=1},n[200]=function(){z80.b|=2},n[201]=function(){z80.c|=2},n[202]=function(){z80.d|=2},n[203]=function(){z80.e|=2},n[204]=function(){z80.h|=2},n[205]=function(){z80.l|=2},n[206]=function(){tstates+=7;writebyte(z80.l|z80.h<<8,readbyte(z80.l|z80.h<<8)|2)},n[207]=function(){z80.a|=2},n[208]=function(){z80.b|=4},n[209]=function(){z80.c|=4},n[210]=function(){z80.d|=4},n[211]=function(){z80.e|=4},n[212]=function(){z80.h|=4},n[213]=function(){z80.l|=4},n[214]=function(){tstates+=7;writebyte(z80.l|z80.h<<8,readbyte(z80.l|z80.h<<8)|4)},n[215]=function(){z80.a|=4},n[216]=function(){z80.b|=8},n[217]=function(){z80.c|=8},n[218]=function(){z80.d|=8},n[219]=function(){z80.e|=8},n[220]=function(){z80.h|=8},n[221]=function(){z80.l|=8},n[222]=function(){tstates+=7;writebyte(z80.l|z80.h<<8,readbyte(z80.l|z80.h<<8)|8)},n[223]=function(){z80.a|=8},n[224]=function(){z80.b|=16},n[225]=function(){z80.c|=16},n[226]=function(){z80.d|=16},n[227]=function(){z80.e|=16},n[228]=function(){z80.h|=16},n[229]=function(){z80.l|=16},n[230]=function(){tstates+=7;writebyte(z80.l|z80.h<<8,readbyte(z80.l|z80.h<<8)|16)},n[231]=function(){z80.a|=16},n[232]=function(){z80.b|=32},n[233]=function(){z80.c|=32},n[234]=function(){z80.d|=32},n[235]=function(){z80.e|=32},n[236]=function(){z80.h|=32},n[237]=function(){z80.l|=32},n[238]=function(){tstates+=7;writebyte(z80.l|z80.h<<8,readbyte(z80.l|z80.h<<8)|32)},n[239]=function(){z80.a|=32},n[240]=function(){z80.b|=64},n[241]=function(){z80.c|=64},n[242]=function(){z80.d|=64},n[243]=function(){z80.e|=64},n[244]=function(){z80.h|=64},n[245]=function(){z80.l|=64},n[246]=function(){tstates+=7;writebyte(z80.l|z80.h<<8,readbyte(z80.l|z80.h<<8)|64)},n[247]=function(){z80.a|=64},n[248]=function(){z80.b|=128},n[249]=function(){z80.c|=128},n[250]=function(){z80.d|=128},n[251]=function(){z80.e|=128},n[252]=function(){z80.h|=128},n[253]=function(){z80.l|=128},n[254]=function(){tstates+=7;writebyte(z80.l|z80.h<<8,readbyte(z80.l|z80.h<<8)|128)},n[255]=function(){z80.a|=128},n[256]=function(){},z80_defaults(n),n}();z80_dd_ops=function(){var n=[];return n[9]=function(){var n=(z80.ixl|z80.ixh<<8)+(z80.c|z80.b<<8),t=((z80.ixl|z80.ixh<<8)&2048)>>11|((z80.c|z80.b<<8)&2048)>>10|(n&2048)>>9;tstates+=7;z80.ixh=n>>8&255;z80.ixl=n&255;z80.f=z80.f&196|(n&65536?1:0)|n>>8&40|halfcarry_add_table[t]},n[25]=function(){var n=(z80.ixl|z80.ixh<<8)+(z80.e|z80.d<<8),t=((z80.ixl|z80.ixh<<8)&2048)>>11|((z80.e|z80.d<<8)&2048)>>10|(n&2048)>>9;tstates+=7;z80.ixh=n>>8&255;z80.ixl=n&255;z80.f=z80.f&196|(n&65536?1:0)|n>>8&40|halfcarry_add_table[t]},n[33]=function(){tstates+=6;z80.ixl=readbyte(z80.pc++);z80.pc&=65535;z80.ixh=readbyte(z80.pc++);z80.pc&=65535},n[34]=function(){var n;tstates+=12;n=readbyte(z80.pc++);z80.pc&=65535;n|=readbyte(z80.pc++)<<8;z80.pc&=65535;writebyte(n++,z80.ixl);n&=65535;writebyte(n,z80.ixh)},n[35]=function(){tstates+=2;var n=(z80.ixl|z80.ixh<<8)+1&65535;z80.ixh=n>>8;z80.ixl=n&255},n[36]=function(){z80.ixh=z80.ixh+1&255;z80.f=z80.f&1|(z80.ixh==128?4:0)|(z80.ixh&15?0:16)|sz53_table[z80.ixh]},n[37]=function(){z80.f=z80.f&1|(z80.ixh&15?0:16)|2;z80.ixh=z80.ixh-1&255;z80.f|=(z80.ixh==127?4:0)|sz53_table[z80.ixh]},n[38]=function(){tstates+=3;z80.ixh=readbyte(z80.pc++);z80.pc&=65535},n[41]=function(){var n=(z80.ixl|z80.ixh<<8)+(z80.ixl|z80.ixh<<8),t=((z80.ixl|z80.ixh<<8)&2048)>>11|((z80.ixl|z80.ixh<<8)&2048)>>10|(n&2048)>>9;tstates+=7;z80.ixh=n>>8&255;z80.ixl=n&255;z80.f=z80.f&196|(n&65536?1:0)|n>>8&40|halfcarry_add_table[t]},n[42]=function(){var n;tstates+=12;n=readbyte(z80.pc++);z80.pc&=65535;n|=readbyte(z80.pc++)<<8;z80.pc&=65535;z80.ixl=readbyte(n++);n&=65535;z80.ixh=readbyte(n)},n[43]=function(){tstates+=2;var n=(z80.ixl|z80.ixh<<8)-1&65535;z80.ixh=n>>8;z80.ixl=n&255},n[44]=function(){z80.ixl=z80.ixl+1&255;z80.f=z80.f&1|(z80.ixl==128?4:0)|(z80.ixl&15?0:16)|sz53_table[z80.ixl]},n[45]=function(){z80.f=z80.f&1|(z80.ixl&15?0:16)|2;z80.ixl=z80.ixl-1&255;z80.f|=(z80.ixl==127?4:0)|sz53_table[z80.ixl]},n[46]=function(){tstates+=3;z80.ixl=readbyte(z80.pc++);z80.pc&=65535},n[52]=function(){var t,n;tstates+=15;t=(z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535;z80.pc&=65535;n=readbyte(t);n=n+1&255;z80.f=z80.f&1|(n==128?4:0)|(n&15?0:16)|sz53_table[n];writebyte(t,n)},n[53]=function(){var t,n;tstates+=15;t=(z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535;z80.pc&=65535;n=readbyte(t);z80.f=z80.f&1|(n&15?0:16)|2;n=n-1&255;z80.f|=(n==127?4:0)|sz53_table[n];writebyte(t,n)},n[54]=function(){tstates+=11;var n=(z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535;z80.pc&=65535;writebyte(n,readbyte(z80.pc++));z80.pc&=65535},n[57]=function(){var n=(z80.ixl|z80.ixh<<8)+z80.sp,t=((z80.ixl|z80.ixh<<8)&2048)>>11|(z80.sp&2048)>>10|(n&2048)>>9;tstates+=7;z80.ixh=n>>8&255;z80.ixl=n&255;z80.f=z80.f&196|(n&65536?1:0)|n>>8&40|halfcarry_add_table[t]},n[68]=function(){z80.b=z80.ixh},n[69]=function(){z80.b=z80.ixl},n[70]=function(){tstates+=11;z80.b=readbyte((z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535},n[76]=function(){z80.c=z80.ixh},n[77]=function(){z80.c=z80.ixl},n[78]=function(){tstates+=11;z80.c=readbyte((z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535},n[84]=function(){z80.d=z80.ixh},n[85]=function(){z80.d=z80.ixl},n[86]=function(){tstates+=11;z80.d=readbyte((z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535},n[92]=function(){z80.e=z80.ixh},n[93]=function(){z80.e=z80.ixl},n[94]=function(){tstates+=11;z80.e=readbyte((z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535},n[96]=function(){z80.ixh=z80.b},n[97]=function(){z80.ixh=z80.c},n[98]=function(){z80.ixh=z80.d},n[99]=function(){z80.ixh=z80.e},n[100]=function(){},n[101]=function(){z80.ixh=z80.ixl},n[102]=function(){tstates+=11;z80.h=readbyte((z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535},n[103]=function(){z80.ixh=z80.a},n[104]=function(){z80.ixl=z80.b},n[105]=function(){z80.ixl=z80.c},n[106]=function(){z80.ixl=z80.d},n[107]=function(){z80.ixl=z80.e},n[108]=function(){z80.ixl=z80.ixh},n[109]=function(){},n[110]=function(){tstates+=11;z80.l=readbyte((z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535},n[111]=function(){z80.ixl=z80.a},n[112]=function(){tstates+=11;writebyte((z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535,z80.b);z80.pc&=65535},n[113]=function(){tstates+=11;writebyte((z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535,z80.c);z80.pc&=65535},n[114]=function(){tstates+=11;writebyte((z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535,z80.d);z80.pc&=65535},n[115]=function(){tstates+=11;writebyte((z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535,z80.e);z80.pc&=65535},n[116]=function(){tstates+=11;writebyte((z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535,z80.h);z80.pc&=65535},n[117]=function(){tstates+=11;writebyte((z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535,z80.l);z80.pc&=65535},n[119]=function(){tstates+=11;writebyte((z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535,z80.a);z80.pc&=65535},n[124]=function(){z80.a=z80.ixh},n[125]=function(){z80.a=z80.ixl},n[126]=function(){tstates+=11;z80.a=readbyte((z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535},n[132]=function(){var n=z80.a+z80.ixh,t=(z80.a&136)>>3|(z80.ixh&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[t&7]|overflow_add_table[t>>4]|sz53_table[z80.a]},n[133]=function(){var n=z80.a+z80.ixl,t=(z80.a&136)>>3|(z80.ixl&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[t&7]|overflow_add_table[t>>4]|sz53_table[z80.a]},n[134]=function(){var t,n,i;tstates+=11;t=readbyte((z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535;n=z80.a+t;i=(z80.a&136)>>3|(t&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[i&7]|overflow_add_table[i>>4]|sz53_table[z80.a]},n[140]=function(){var n=z80.a+z80.ixh+(z80.f&1),t=(z80.a&136)>>3|(z80.ixh&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[t&7]|overflow_add_table[t>>4]|sz53_table[z80.a]},n[141]=function(){var n=z80.a+z80.ixl+(z80.f&1),t=(z80.a&136)>>3|(z80.ixl&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[t&7]|overflow_add_table[t>>4]|sz53_table[z80.a]},n[142]=function(){var t,n,i;tstates+=11;t=readbyte((z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535;n=z80.a+t+(z80.f&1);i=(z80.a&136)>>3|(t&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[i&7]|overflow_add_table[i>>4]|sz53_table[z80.a]},n[148]=function(){var n=z80.a-z80.ixh,t=(z80.a&136)>>3|(z80.ixh&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|sz53_table[z80.a]},n[149]=function(){var n=z80.a-z80.ixl,t=(z80.a&136)>>3|(z80.ixl&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|sz53_table[z80.a]},n[150]=function(){var t,n,i;tstates+=11;t=readbyte((z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535;n=z80.a-t;i=(z80.a&136)>>3|(t&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[i&7]|overflow_sub_table[i>>4]|sz53_table[z80.a]},n[156]=function(){var n=z80.a-z80.ixh-(z80.f&1),t=(z80.a&136)>>3|(z80.ixh&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|sz53_table[z80.a]},n[157]=function(){var n=z80.a-z80.ixl-(z80.f&1),t=(z80.a&136)>>3|(z80.ixl&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|sz53_table[z80.a]},n[158]=function(){var t,n,i;tstates+=11;t=readbyte((z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535;n=z80.a-t-(z80.f&1);i=(z80.a&136)>>3|(t&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[i&7]|overflow_sub_table[i>>4]|sz53_table[z80.a]},n[164]=function(){z80.a&=z80.ixh;z80.f=16|sz53p_table[z80.a]},n[165]=function(){z80.a&=z80.ixl;z80.f=16|sz53p_table[z80.a]},n[166]=function(){tstates+=11;var n=readbyte((z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535;z80.a&=n;z80.f=16|sz53p_table[z80.a]},n[172]=function(){z80.a^=z80.ixh;z80.f=sz53p_table[z80.a]},n[173]=function(){z80.a^=z80.ixl;z80.f=sz53p_table[z80.a]},n[174]=function(){tstates+=11;var n=readbyte((z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535;z80.a^=n;z80.f=sz53p_table[z80.a]},n[180]=function(){z80.a|=z80.ixh;z80.f=sz53p_table[z80.a]},n[181]=function(){z80.a|=z80.ixl;z80.f=sz53p_table[z80.a]},n[182]=function(){tstates+=11;var n=readbyte((z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535;z80.a|=n;z80.f=sz53p_table[z80.a]},n[188]=function(){var n=z80.a-z80.ixh,t=(z80.a&136)>>3|(z80.ixh&136)>>2|(n&136)>>1;z80.f=(n&256?1:n?0:64)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|z80.ixh&40|n&128},n[189]=function(){var n=z80.a-z80.ixl,t=(z80.a&136)>>3|(z80.ixl&136)>>2|(n&136)>>1;z80.f=(n&256?1:n?0:64)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|z80.ixl&40|n&128},n[190]=function(){var t,n,i;tstates+=11;t=readbyte((z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535;n=z80.a-t;i=(z80.a&136)>>3|(t&136)>>2|(n&136)>>1;z80.f=(n&256?1:n?0:64)|2|halfcarry_sub_table[i&7]|overflow_sub_table[i>>4]|t&40|n&128},n[203]=function(n){var t;tstates+=7;n=(z80.ixl|z80.ixh<<8)+sign_extend(readbyte(z80.pc++));z80.pc&=65535;t=readbyte(z80.pc++);z80.pc&=65535;z80_ddfdcbxx(t,n)},n[225]=function(){tstates+=6;z80.ixl=readbyte(z80.sp++);z80.sp&=65535;z80.ixh=readbyte(z80.sp++);z80.sp&=65535},n[227]=function(){var n=readbyte(z80.sp),t=readbyte(z80.sp+1);tstates+=15;writebyte(z80.sp+1,z80.ixh);writebyte(z80.sp,z80.ixl);z80.ixl=n;z80.ixh=t},n[229]=function(){tstates++;tstates+=6;z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.ixh);z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.ixl)},n[233]=function(){z80.pc=z80.ixl|z80.ixh<<8},n[249]=function(){tstates+=2;z80.sp=z80.ixl|z80.ixh<<8},n[256]=function(){z80.pc--;z80.pc&=65535;z80.r--;z80.r&=127},z80_defaults(n),n}();z80_fd_ops=function(){var n=[];return n[9]=function(){var n=(z80.iyl|z80.iyh<<8)+(z80.c|z80.b<<8),t=((z80.iyl|z80.iyh<<8)&2048)>>11|((z80.c|z80.b<<8)&2048)>>10|(n&2048)>>9;tstates+=7;z80.iyh=n>>8&255;z80.iyl=n&255;z80.f=z80.f&196|(n&65536?1:0)|n>>8&40|halfcarry_add_table[t]},n[25]=function(){var n=(z80.iyl|z80.iyh<<8)+(z80.e|z80.d<<8),t=((z80.iyl|z80.iyh<<8)&2048)>>11|((z80.e|z80.d<<8)&2048)>>10|(n&2048)>>9;tstates+=7;z80.iyh=n>>8&255;z80.iyl=n&255;z80.f=z80.f&196|(n&65536?1:0)|n>>8&40|halfcarry_add_table[t]},n[33]=function(){tstates+=6;z80.iyl=readbyte(z80.pc++);z80.pc&=65535;z80.iyh=readbyte(z80.pc++);z80.pc&=65535},n[34]=function(){var n;tstates+=12;n=readbyte(z80.pc++);z80.pc&=65535;n|=readbyte(z80.pc++)<<8;z80.pc&=65535;writebyte(n++,z80.iyl);n&=65535;writebyte(n,z80.iyh)},n[35]=function(){tstates+=2;var n=(z80.iyl|z80.iyh<<8)+1&65535;z80.iyh=n>>8;z80.iyl=n&255},n[36]=function(){z80.iyh=z80.iyh+1&255;z80.f=z80.f&1|(z80.iyh==128?4:0)|(z80.iyh&15?0:16)|sz53_table[z80.iyh]},n[37]=function(){z80.f=z80.f&1|(z80.iyh&15?0:16)|2;z80.iyh=z80.iyh-1&255;z80.f|=(z80.iyh==127?4:0)|sz53_table[z80.iyh]},n[38]=function(){tstates+=3;z80.iyh=readbyte(z80.pc++);z80.pc&=65535},n[41]=function(){var n=(z80.iyl|z80.iyh<<8)+(z80.iyl|z80.iyh<<8),t=((z80.iyl|z80.iyh<<8)&2048)>>11|((z80.iyl|z80.iyh<<8)&2048)>>10|(n&2048)>>9;tstates+=7;z80.iyh=n>>8&255;z80.iyl=n&255;z80.f=z80.f&196|(n&65536?1:0)|n>>8&40|halfcarry_add_table[t]},n[42]=function(){var n;tstates+=12;n=readbyte(z80.pc++);z80.pc&=65535;n|=readbyte(z80.pc++)<<8;z80.pc&=65535;z80.iyl=readbyte(n++);n&=65535;z80.iyh=readbyte(n)},n[43]=function(){tstates+=2;var n=(z80.iyl|z80.iyh<<8)-1&65535;z80.iyh=n>>8;z80.iyl=n&255},n[44]=function(){z80.iyl=z80.iyl+1&255;z80.f=z80.f&1|(z80.iyl==128?4:0)|(z80.iyl&15?0:16)|sz53_table[z80.iyl]},n[45]=function(){z80.f=z80.f&1|(z80.iyl&15?0:16)|2;z80.iyl=z80.iyl-1&255;z80.f|=(z80.iyl==127?4:0)|sz53_table[z80.iyl]},n[46]=function(){tstates+=3;z80.iyl=readbyte(z80.pc++);z80.pc&=65535},n[52]=function(){var t,n;tstates+=15;t=(z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535;z80.pc&=65535;n=readbyte(t);n=n+1&255;z80.f=z80.f&1|(n==128?4:0)|(n&15?0:16)|sz53_table[n];writebyte(t,n)},n[53]=function(){var t,n;tstates+=15;t=(z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535;z80.pc&=65535;n=readbyte(t);z80.f=z80.f&1|(n&15?0:16)|2;n=n-1&255;z80.f|=(n==127?4:0)|sz53_table[n];writebyte(t,n)},n[54]=function(){tstates+=11;var n=(z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535;z80.pc&=65535;writebyte(n,readbyte(z80.pc++));z80.pc&=65535},n[57]=function(){var n=(z80.iyl|z80.iyh<<8)+z80.sp,t=((z80.iyl|z80.iyh<<8)&2048)>>11|(z80.sp&2048)>>10|(n&2048)>>9;tstates+=7;z80.iyh=n>>8&255;z80.iyl=n&255;z80.f=z80.f&196|(n&65536?1:0)|n>>8&40|halfcarry_add_table[t]},n[68]=function(){z80.b=z80.iyh},n[69]=function(){z80.b=z80.iyl},n[70]=function(){tstates+=11;z80.b=readbyte((z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535},n[76]=function(){z80.c=z80.iyh},n[77]=function(){z80.c=z80.iyl},n[78]=function(){tstates+=11;z80.c=readbyte((z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535},n[84]=function(){z80.d=z80.iyh},n[85]=function(){z80.d=z80.iyl},n[86]=function(){tstates+=11;z80.d=readbyte((z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535},n[92]=function(){z80.e=z80.iyh},n[93]=function(){z80.e=z80.iyl},n[94]=function(){tstates+=11;z80.e=readbyte((z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535},n[96]=function(){z80.iyh=z80.b},n[97]=function(){z80.iyh=z80.c},n[98]=function(){z80.iyh=z80.d},n[99]=function(){z80.iyh=z80.e},n[100]=function(){},n[101]=function(){z80.iyh=z80.iyl},n[102]=function(){tstates+=11;z80.h=readbyte((z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535},n[103]=function(){z80.iyh=z80.a},n[104]=function(){z80.iyl=z80.b},n[105]=function(){z80.iyl=z80.c},n[106]=function(){z80.iyl=z80.d},n[107]=function(){z80.iyl=z80.e},n[108]=function(){z80.iyl=z80.iyh},n[109]=function(){},n[110]=function(){tstates+=11;z80.l=readbyte((z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535},n[111]=function(){z80.iyl=z80.a},n[112]=function(){tstates+=11;writebyte((z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535,z80.b);z80.pc&=65535},n[113]=function(){tstates+=11;writebyte((z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535,z80.c);z80.pc&=65535},n[114]=function(){tstates+=11;writebyte((z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535,z80.d);z80.pc&=65535},n[115]=function(){tstates+=11;writebyte((z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535,z80.e);z80.pc&=65535},n[116]=function(){tstates+=11;writebyte((z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535,z80.h);z80.pc&=65535},n[117]=function(){tstates+=11;writebyte((z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535,z80.l);z80.pc&=65535},n[119]=function(){tstates+=11;writebyte((z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535,z80.a);z80.pc&=65535},n[124]=function(){z80.a=z80.iyh},n[125]=function(){z80.a=z80.iyl},n[126]=function(){tstates+=11;z80.a=readbyte((z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535},n[132]=function(){var n=z80.a+z80.iyh,t=(z80.a&136)>>3|(z80.iyh&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[t&7]|overflow_add_table[t>>4]|sz53_table[z80.a]},n[133]=function(){var n=z80.a+z80.iyl,t=(z80.a&136)>>3|(z80.iyl&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[t&7]|overflow_add_table[t>>4]|sz53_table[z80.a]},n[134]=function(){var t,n,i;tstates+=11;t=readbyte((z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535;n=z80.a+t;i=(z80.a&136)>>3|(t&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[i&7]|overflow_add_table[i>>4]|sz53_table[z80.a]},n[140]=function(){var n=z80.a+z80.iyh+(z80.f&1),t=(z80.a&136)>>3|(z80.iyh&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[t&7]|overflow_add_table[t>>4]|sz53_table[z80.a]},n[141]=function(){var n=z80.a+z80.iyl+(z80.f&1),t=(z80.a&136)>>3|(z80.iyl&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[t&7]|overflow_add_table[t>>4]|sz53_table[z80.a]},n[142]=function(){var t,n,i;tstates+=11;t=readbyte((z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535;n=z80.a+t+(z80.f&1);i=(z80.a&136)>>3|(t&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|halfcarry_add_table[i&7]|overflow_add_table[i>>4]|sz53_table[z80.a]},n[148]=function(){var n=z80.a-z80.iyh,t=(z80.a&136)>>3|(z80.iyh&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|sz53_table[z80.a]},n[149]=function(){var n=z80.a-z80.iyl,t=(z80.a&136)>>3|(z80.iyl&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|sz53_table[z80.a]},n[150]=function(){var t,n,i;tstates+=11;t=readbyte((z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535;n=z80.a-t;i=(z80.a&136)>>3|(t&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[i&7]|overflow_sub_table[i>>4]|sz53_table[z80.a]},n[156]=function(){var n=z80.a-z80.iyh-(z80.f&1),t=(z80.a&136)>>3|(z80.iyh&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|sz53_table[z80.a]},n[157]=function(){var n=z80.a-z80.iyl-(z80.f&1),t=(z80.a&136)>>3|(z80.iyl&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|sz53_table[z80.a]},n[158]=function(){var t,n,i;tstates+=11;t=readbyte((z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535;n=z80.a-t-(z80.f&1);i=(z80.a&136)>>3|(t&136)>>2|(n&136)>>1;z80.a=n&255;z80.f=(n&256?1:0)|2|halfcarry_sub_table[i&7]|overflow_sub_table[i>>4]|sz53_table[z80.a]},n[164]=function(){z80.a&=z80.iyh;z80.f=16|sz53p_table[z80.a]},n[165]=function(){z80.a&=z80.iyl;z80.f=16|sz53p_table[z80.a]},n[166]=function(){tstates+=11;var n=readbyte((z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535;z80.a&=n;z80.f=16|sz53p_table[z80.a]},n[172]=function(){z80.a^=z80.iyh;z80.f=sz53p_table[z80.a]},n[173]=function(){z80.a^=z80.iyl;z80.f=sz53p_table[z80.a]},n[174]=function(){tstates+=11;var n=readbyte((z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535;z80.a^=n;z80.f=sz53p_table[z80.a]},n[180]=function(){z80.a|=z80.iyh;z80.f=sz53p_table[z80.a]},n[181]=function(){z80.a|=z80.iyl;z80.f=sz53p_table[z80.a]},n[182]=function(){tstates+=11;var n=readbyte((z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535;z80.a|=n;z80.f=sz53p_table[z80.a]},n[188]=function(){var n=z80.a-z80.iyh,t=(z80.a&136)>>3|(z80.iyh&136)>>2|(n&136)>>1;z80.f=(n&256?1:n?0:64)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|z80.iyh&40|n&128},n[189]=function(){var n=z80.a-z80.iyl,t=(z80.a&136)>>3|(z80.iyl&136)>>2|(n&136)>>1;z80.f=(n&256?1:n?0:64)|2|halfcarry_sub_table[t&7]|overflow_sub_table[t>>4]|z80.iyl&40|n&128},n[190]=function(){var t,n,i;tstates+=11;t=readbyte((z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++))&65535);z80.pc&=65535;n=z80.a-t;i=(z80.a&136)>>3|(t&136)>>2|(n&136)>>1;z80.f=(n&256?1:n?0:64)|2|halfcarry_sub_table[i&7]|overflow_sub_table[i>>4]|t&40|n&128},n[203]=function(n){var t;tstates+=7;n=(z80.iyl|z80.iyh<<8)+sign_extend(readbyte(z80.pc++));z80.pc&=65535;t=readbyte(z80.pc++);z80.pc&=65535;z80_ddfdcbxx(t,n)},n[225]=function(){tstates+=6;z80.iyl=readbyte(z80.sp++);z80.sp&=65535;z80.iyh=readbyte(z80.sp++);z80.sp&=65535},n[227]=function(){var n=readbyte(z80.sp),t=readbyte(z80.sp+1);tstates+=15;writebyte(z80.sp+1,z80.iyh);writebyte(z80.sp,z80.iyl);z80.iyl=n;z80.iyh=t},n[229]=function(){tstates++;tstates+=6;z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.iyh);z80.sp--;z80.sp&=65535;writebyte(z80.sp,z80.iyl)},n[233]=function(){z80.pc=z80.iyl|z80.iyh<<8},n[249]=function(){tstates+=2;z80.sp=z80.iyl|z80.iyh<<8},n[256]=function(){z80.pc--;z80.pc&=65535;z80.r--;z80.r&=127},z80_defaults(n),n}();z80_ddfdcb_ops=function(){var n=[];return n[0]=function(n){tstates+=8;z80.b=readbyte(n);z80.b=(z80.b&127)<<1|z80.b>>7;z80.f=z80.b&1|sz53p_table[z80.b];writebyte(n,z80.b)},n[1]=function(n){tstates+=8;z80.c=readbyte(n);z80.c=(z80.c&127)<<1|z80.c>>7;z80.f=z80.c&1|sz53p_table[z80.c];writebyte(n,z80.c)},n[2]=function(n){tstates+=8;z80.d=readbyte(n);z80.d=(z80.d&127)<<1|z80.d>>7;z80.f=z80.d&1|sz53p_table[z80.d];writebyte(n,z80.d)},n[3]=function(n){tstates+=8;z80.e=readbyte(n);z80.e=(z80.e&127)<<1|z80.e>>7;z80.f=z80.e&1|sz53p_table[z80.e];writebyte(n,z80.e)},n[4]=function(n){tstates+=8;z80.h=readbyte(n);z80.h=(z80.h&127)<<1|z80.h>>7;z80.f=z80.h&1|sz53p_table[z80.h];writebyte(n,z80.h)},n[5]=function(n){tstates+=8;z80.l=readbyte(n);z80.l=(z80.l&127)<<1|z80.l>>7;z80.f=z80.l&1|sz53p_table[z80.l];writebyte(n,z80.l)},n[6]=function(n){tstates+=8;var t=readbyte(n);t=(t&127)<<1|t>>7;z80.f=t&1|sz53p_table[t];writebyte(n,t)},n[7]=function(n){tstates+=8;z80.a=readbyte(n);z80.a=(z80.a&127)<<1|z80.a>>7;z80.f=z80.a&1|sz53p_table[z80.a];writebyte(n,z80.a)},n[8]=function(n){tstates+=8;z80.b=readbyte(n);z80.f=z80.b&1;z80.b=z80.b>>1|(z80.b&1)<<7;z80.f|=sz53p_table[z80.b];writebyte(n,z80.b)},n[9]=function(n){tstates+=8;z80.c=readbyte(n);z80.f=z80.c&1;z80.c=z80.c>>1|(z80.c&1)<<7;z80.f|=sz53p_table[z80.c];writebyte(n,z80.c)},n[10]=function(n){tstates+=8;z80.d=readbyte(n);z80.f=z80.d&1;z80.d=z80.d>>1|(z80.d&1)<<7;z80.f|=sz53p_table[z80.d];writebyte(n,z80.d)},n[11]=function(n){tstates+=8;z80.e=readbyte(n);z80.f=z80.e&1;z80.e=z80.e>>1|(z80.e&1)<<7;z80.f|=sz53p_table[z80.e];writebyte(n,z80.e)},n[12]=function(n){tstates+=8;z80.h=readbyte(n);z80.f=z80.h&1;z80.h=z80.h>>1|(z80.h&1)<<7;z80.f|=sz53p_table[z80.h];writebyte(n,z80.h)},n[13]=function(n){tstates+=8;z80.l=readbyte(n);z80.f=z80.l&1;z80.l=z80.l>>1|(z80.l&1)<<7;z80.f|=sz53p_table[z80.l];writebyte(n,z80.l)},n[14]=function(n){tstates+=8;var t=readbyte(n);z80.f=t&1;t=t>>1|(t&1)<<7;z80.f|=sz53p_table[t];writebyte(n,t)},n[15]=function(n){tstates+=8;z80.a=readbyte(n);z80.f=z80.a&1;z80.a=z80.a>>1|(z80.a&1)<<7;z80.f|=sz53p_table[z80.a];writebyte(n,z80.a)},n[16]=function(n){tstates+=8;z80.b=readbyte(n);var t=z80.b;z80.b=(z80.b&127)<<1|z80.f&1;z80.f=t>>7|sz53p_table[z80.b];writebyte(n,z80.b)},n[17]=function(n){tstates+=8;z80.c=readbyte(n);var t=z80.c;z80.c=(z80.c&127)<<1|z80.f&1;z80.f=t>>7|sz53p_table[z80.c];writebyte(n,z80.c)},n[18]=function(n){tstates+=8;z80.d=readbyte(n);var t=z80.d;z80.d=(z80.d&127)<<1|z80.f&1;z80.f=t>>7|sz53p_table[z80.d];writebyte(n,z80.d)},n[19]=function(n){tstates+=8;z80.e=readbyte(n);var t=z80.e;z80.e=(z80.e&127)<<1|z80.f&1;z80.f=t>>7|sz53p_table[z80.e];writebyte(n,z80.e)},n[20]=function(n){tstates+=8;z80.h=readbyte(n);var t=z80.h;z80.h=(z80.h&127)<<1|z80.f&1;z80.f=t>>7|sz53p_table[z80.h];writebyte(n,z80.h)},n[21]=function(n){tstates+=8;z80.l=readbyte(n);var t=z80.l;z80.l=(z80.l&127)<<1|z80.f&1;z80.f=t>>7|sz53p_table[z80.l];writebyte(n,z80.l)},n[22]=function(n){tstates+=8;var t=readbyte(n),i=t;t=(t&127)<<1|z80.f&1;z80.f=i>>7|sz53p_table[t];writebyte(n,t)},n[23]=function(n){tstates+=8;z80.a=readbyte(n);var t=z80.a;z80.a=(z80.a&127)<<1|z80.f&1;z80.f=t>>7|sz53p_table[z80.a];writebyte(n,z80.a)},n[24]=function(n){tstates+=8;z80.b=readbyte(n);var t=z80.b;z80.b=z80.b>>1|(z80.f&1)<<7;z80.f=t&1|sz53p_table[z80.b];writebyte(n,z80.b)},n[25]=function(n){tstates+=8;z80.c=readbyte(n);var t=z80.c;z80.c=z80.c>>1|(z80.f&1)<<7;z80.f=t&1|sz53p_table[z80.c];writebyte(n,z80.c)},n[26]=function(n){tstates+=8;z80.d=readbyte(n);var t=z80.d;z80.d=z80.d>>1|(z80.f&1)<<7;z80.f=t&1|sz53p_table[z80.d];writebyte(n,z80.d)},n[27]=function(n){tstates+=8;z80.e=readbyte(n);var t=z80.e;z80.e=z80.e>>1|(z80.f&1)<<7;z80.f=t&1|sz53p_table[z80.e];writebyte(n,z80.e)},n[28]=function(n){tstates+=8;z80.h=readbyte(n);var t=z80.h;z80.h=z80.h>>1|(z80.f&1)<<7;z80.f=t&1|sz53p_table[z80.h];writebyte(n,z80.h)},n[29]=function(n){tstates+=8;z80.l=readbyte(n);var t=z80.l;z80.l=z80.l>>1|(z80.f&1)<<7;z80.f=t&1|sz53p_table[z80.l];writebyte(n,z80.l)},n[30]=function(n){tstates+=8;var t=readbyte(n),i=t;t=t>>1|(z80.f&1)<<7;z80.f=i&1|sz53p_table[t];writebyte(n,t)},n[31]=function(n){tstates+=8;z80.a=readbyte(n);var t=z80.a;z80.a=z80.a>>1|(z80.f&1)<<7;z80.f=t&1|sz53p_table[z80.a];writebyte(n,z80.a)},n[32]=function(n){tstates+=8;z80.b=readbyte(n);z80.f=z80.b>>7;z80.b<<=1;z80.b&=255;z80.f|=sz53p_table[z80.b];writebyte(n,z80.b)},n[33]=function(n){tstates+=8;z80.c=readbyte(n);z80.f=z80.c>>7;z80.c<<=1;z80.c&=255;z80.f|=sz53p_table[z80.c];writebyte(n,z80.c)},n[34]=function(n){tstates+=8;z80.d=readbyte(n);z80.f=z80.d>>7;z80.d<<=1;z80.d&=255;z80.f|=sz53p_table[z80.d];writebyte(n,z80.d)},n[35]=function(n){tstates+=8;z80.e=readbyte(n);z80.f=z80.e>>7;z80.e<<=1;z80.e&=255;z80.f|=sz53p_table[z80.e];writebyte(n,z80.e)},n[36]=function(n){tstates+=8;z80.h=readbyte(n);z80.f=z80.h>>7;z80.h<<=1;z80.h&=255;z80.f|=sz53p_table[z80.h];writebyte(n,z80.h)},n[37]=function(n){tstates+=8;z80.l=readbyte(n);z80.f=z80.l>>7;z80.l<<=1;z80.l&=255;z80.f|=sz53p_table[z80.l];writebyte(n,z80.l)},n[38]=function(n){tstates+=8;var t=readbyte(n);z80.f=t>>7;t<<=1;t&=255;z80.f|=sz53p_table[t];writebyte(n,t)},n[39]=function(n){tstates+=8;z80.a=readbyte(n);z80.f=z80.a>>7;z80.a<<=1;z80.a&=255;z80.f|=sz53p_table[z80.a];writebyte(n,z80.a)},n[40]=function(n){tstates+=8;z80.b=readbyte(n);z80.f=z80.b&1;z80.b=z80.b&128|z80.b>>1;z80.f|=sz53p_table[z80.b];writebyte(n,z80.b)},n[41]=function(n){tstates+=8;z80.c=readbyte(n);z80.f=z80.c&1;z80.c=z80.c&128|z80.c>>1;z80.f|=sz53p_table[z80.c];writebyte(n,z80.c)},n[42]=function(n){tstates+=8;z80.d=readbyte(n);z80.f=z80.d&1;z80.d=z80.d&128|z80.d>>1;z80.f|=sz53p_table[z80.d];writebyte(n,z80.d)},n[43]=function(n){tstates+=8;z80.e=readbyte(n);z80.f=z80.e&1;z80.e=z80.e&128|z80.e>>1;z80.f|=sz53p_table[z80.e];writebyte(n,z80.e)},n[44]=function(n){tstates+=8;z80.h=readbyte(n);z80.f=z80.h&1;z80.h=z80.h&128|z80.h>>1;z80.f|=sz53p_table[z80.h];writebyte(n,z80.h)},n[45]=function(n){tstates+=8;z80.l=readbyte(n);z80.f=z80.l&1;z80.l=z80.l&128|z80.l>>1;z80.f|=sz53p_table[z80.l];writebyte(n,z80.l)},n[46]=function(n){tstates+=8;var t=readbyte(n);z80.f=t&1;t=t&128|t>>1;z80.f|=sz53p_table[t];writebyte(n,t)},n[47]=function(n){tstates+=8;z80.a=readbyte(n);z80.f=z80.a&1;z80.a=z80.a&128|z80.a>>1;z80.f|=sz53p_table[z80.a];writebyte(n,z80.a)},n[48]=function(n){tstates+=8;z80.b=readbyte(n);z80.f=z80.b>>7;z80.b=z80.b<<1|1;z80.b&=255;z80.f|=sz53p_table[z80.b];writebyte(n,z80.b)},n[49]=function(n){tstates+=8;z80.c=readbyte(n);z80.f=z80.c>>7;z80.c=z80.c<<1|1;z80.c&=255;z80.f|=sz53p_table[z80.c];writebyte(n,z80.c)},n[50]=function(n){tstates+=8;z80.d=readbyte(n);z80.f=z80.d>>7;z80.d=z80.d<<1|1;z80.d&=255;z80.f|=sz53p_table[z80.d];writebyte(n,z80.d)},n[51]=function(n){tstates+=8;z80.e=readbyte(n);z80.f=z80.e>>7;z80.e=z80.e<<1|1;z80.e&=255;z80.f|=sz53p_table[z80.e];writebyte(n,z80.e)},n[52]=function(n){tstates+=8;z80.h=readbyte(n);z80.f=z80.h>>7;z80.h=z80.h<<1|1;z80.h&=255;z80.f|=sz53p_table[z80.h];writebyte(n,z80.h)},n[53]=function(n){tstates+=8;z80.l=readbyte(n);z80.f=z80.l>>7;z80.l=z80.l<<1|1;z80.l&=255;z80.f|=sz53p_table[z80.l];writebyte(n,z80.l)},n[54]=function(n){tstates+=8;var t=readbyte(n);z80.f=t>>7;t=t<<1|1;t&=255;z80.f|=sz53p_table[t];writebyte(n,t)},n[55]=function(n){tstates+=8;z80.a=readbyte(n);z80.f=z80.a>>7;z80.a=z80.a<<1|1;z80.a&=255;z80.f|=sz53p_table[z80.a];writebyte(n,z80.a)},n[56]=function(n){tstates+=8;z80.b=readbyte(n);z80.f=z80.b&1;z80.b>>=1;z80.f|=sz53p_table[z80.b];writebyte(n,z80.b)},n[57]=function(n){tstates+=8;z80.c=readbyte(n);z80.f=z80.c&1;z80.c>>=1;z80.f|=sz53p_table[z80.c];writebyte(n,z80.c)},n[58]=function(n){tstates+=8;z80.d=readbyte(n);z80.f=z80.d&1;z80.d>>=1;z80.f|=sz53p_table[z80.d];writebyte(n,z80.d)},n[59]=function(n){tstates+=8;z80.e=readbyte(n);z80.f=z80.e&1;z80.e>>=1;z80.f|=sz53p_table[z80.e];writebyte(n,z80.e)},n[60]=function(n){tstates+=8;z80.h=readbyte(n);z80.f=z80.h&1;z80.h>>=1;z80.f|=sz53p_table[z80.h];writebyte(n,z80.h)},n[61]=function(n){tstates+=8;z80.l=readbyte(n);z80.f=z80.l&1;z80.l>>=1;z80.f|=sz53p_table[z80.l];writebyte(n,z80.l)},n[62]=function(n){tstates+=8;var t=readbyte(n);z80.f=t&1;t>>=1;z80.f|=sz53p_table[t];writebyte(n,t)},n[63]=function(n){tstates+=8;z80.a=readbyte(n);z80.f=z80.a&1;z80.a>>=1;z80.f|=sz53p_table[z80.a];writebyte(n,z80.a)},n[64]=n[65]=n[66]=n[67]=n[68]=n[69]=n[70]=n[71]=function(n){tstates+=5;var t=readbyte(n);z80.f=z80.f&1|16|n>>8&40;t&1||(z80.f|=68);!1&&t&128&&(z80.f|=128)},n[72]=n[73]=n[74]=n[75]=n[76]=n[77]=n[78]=n[79]=function(n){tstates+=5;var t=readbyte(n);z80.f=z80.f&1|16|n>>8&40;t&2||(z80.f|=68);!1&&t&128&&(z80.f|=128)},n[80]=n[81]=n[82]=n[83]=n[84]=n[85]=n[86]=n[87]=function(n){tstates+=5;var t=readbyte(n);z80.f=z80.f&1|16|n>>8&40;t&4||(z80.f|=68);!1&&t&128&&(z80.f|=128)},n[88]=n[89]=n[90]=n[91]=n[92]=n[93]=n[94]=n[95]=function(n){tstates+=5;var t=readbyte(n);z80.f=z80.f&1|16|n>>8&40;t&8||(z80.f|=68);!1&&t&128&&(z80.f|=128)},n[96]=n[97]=n[98]=n[99]=n[100]=n[101]=n[102]=n[103]=function(n){tstates+=5;var t=readbyte(n);z80.f=z80.f&1|16|n>>8&40;t&16||(z80.f|=68);!1&&t&128&&(z80.f|=128)},n[104]=n[105]=n[106]=n[107]=n[108]=n[109]=n[110]=n[111]=function(n){tstates+=5;var t=readbyte(n);z80.f=z80.f&1|16|n>>8&40;t&32||(z80.f|=68);!1&&t&128&&(z80.f|=128)},n[112]=n[113]=n[114]=n[115]=n[116]=n[117]=n[118]=n[119]=function(n){tstates+=5;var t=readbyte(n);z80.f=z80.f&1|16|n>>8&40;t&64||(z80.f|=68);!1&&t&128&&(z80.f|=128)},n[120]=n[121]=n[122]=n[123]=n[124]=n[125]=n[126]=n[127]=function(n){tstates+=5;var t=readbyte(n);z80.f=z80.f&1|16|n>>8&40;t&128||(z80.f|=68);!0&&t&128&&(z80.f|=128)},n[128]=function(n){tstates+=8;z80.b=readbyte(n)&254;writebyte(n,z80.b)},n[129]=function(n){tstates+=8;z80.c=readbyte(n)&254;writebyte(n,z80.c)},n[130]=function(n){tstates+=8;z80.d=readbyte(n)&254;writebyte(n,z80.d)},n[131]=function(n){tstates+=8;z80.e=readbyte(n)&254;writebyte(n,z80.e)},n[132]=function(n){tstates+=8;z80.h=readbyte(n)&254;writebyte(n,z80.h)},n[133]=function(n){tstates+=8;z80.l=readbyte(n)&254;writebyte(n,z80.l)},n[134]=function(n){tstates+=8;writebyte(n,readbyte(n)&254)},n[135]=function(n){tstates+=8;z80.a=readbyte(n)&254;writebyte(n,z80.a)},n[136]=function(n){tstates+=8;z80.b=readbyte(n)&253;writebyte(n,z80.b)},n[137]=function(n){tstates+=8;z80.c=readbyte(n)&253;writebyte(n,z80.c)},n[138]=function(n){tstates+=8;z80.d=readbyte(n)&253;writebyte(n,z80.d)},n[139]=function(n){tstates+=8;z80.e=readbyte(n)&253;writebyte(n,z80.e)},n[140]=function(n){tstates+=8;z80.h=readbyte(n)&253;writebyte(n,z80.h)},n[141]=function(n){tstates+=8;z80.l=readbyte(n)&253;writebyte(n,z80.l)},n[142]=function(n){tstates+=8;writebyte(n,readbyte(n)&253)},n[143]=function(n){tstates+=8;z80.a=readbyte(n)&253;writebyte(n,z80.a)},n[144]=function(n){tstates+=8;z80.b=readbyte(n)&251;writebyte(n,z80.b)},n[145]=function(n){tstates+=8;z80.c=readbyte(n)&251;writebyte(n,z80.c)},n[146]=function(n){tstates+=8;z80.d=readbyte(n)&251;writebyte(n,z80.d)},n[147]=function(n){tstates+=8;z80.e=readbyte(n)&251;writebyte(n,z80.e)},n[148]=function(n){tstates+=8;z80.h=readbyte(n)&251;writebyte(n,z80.h)},n[149]=function(n){tstates+=8;z80.l=readbyte(n)&251;writebyte(n,z80.l)},n[150]=function(n){tstates+=8;writebyte(n,readbyte(n)&251)},n[151]=function(n){tstates+=8;z80.a=readbyte(n)&251;writebyte(n,z80.a)},n[152]=function(n){tstates+=8;z80.b=readbyte(n)&247;writebyte(n,z80.b)},n[153]=function(n){tstates+=8;z80.c=readbyte(n)&247;writebyte(n,z80.c)},n[154]=function(n){tstates+=8;z80.d=readbyte(n)&247;writebyte(n,z80.d)},n[155]=function(n){tstates+=8;z80.e=readbyte(n)&247;writebyte(n,z80.e)},n[156]=function(n){tstates+=8;z80.h=readbyte(n)&247;writebyte(n,z80.h)},n[157]=function(n){tstates+=8;z80.l=readbyte(n)&247;writebyte(n,z80.l)},n[158]=function(n){tstates+=8;writebyte(n,readbyte(n)&247)},n[159]=function(n){tstates+=8;z80.a=readbyte(n)&247;writebyte(n,z80.a)},n[160]=function(n){tstates+=8;z80.b=readbyte(n)&239;writebyte(n,z80.b)},n[161]=function(n){tstates+=8;z80.c=readbyte(n)&239;writebyte(n,z80.c)},n[162]=function(n){tstates+=8;z80.d=readbyte(n)&239;writebyte(n,z80.d)},n[163]=function(n){tstates+=8;z80.e=readbyte(n)&239;writebyte(n,z80.e)},n[164]=function(n){tstates+=8;z80.h=readbyte(n)&239;writebyte(n,z80.h)},n[165]=function(n){tstates+=8;z80.l=readbyte(n)&239;writebyte(n,z80.l)},n[166]=function(n){tstates+=8;writebyte(n,readbyte(n)&239)},n[167]=function(n){tstates+=8;z80.a=readbyte(n)&239;writebyte(n,z80.a)},n[168]=function(n){tstates+=8;z80.b=readbyte(n)&223;writebyte(n,z80.b)},n[169]=function(n){tstates+=8;z80.c=readbyte(n)&223;writebyte(n,z80.c)},n[170]=function(n){tstates+=8;z80.d=readbyte(n)&223;writebyte(n,z80.d)},n[171]=function(n){tstates+=8;z80.e=readbyte(n)&223;writebyte(n,z80.e)},n[172]=function(n){tstates+=8;z80.h=readbyte(n)&223;writebyte(n,z80.h)},n[173]=function(n){tstates+=8;z80.l=readbyte(n)&223;writebyte(n,z80.l)},n[174]=function(n){tstates+=8;writebyte(n,readbyte(n)&223)},n[175]=function(n){tstates+=8;z80.a=readbyte(n)&223;writebyte(n,z80.a)},n[176]=function(n){tstates+=8;z80.b=readbyte(n)&191;writebyte(n,z80.b)},n[177]=function(n){tstates+=8;z80.c=readbyte(n)&191;writebyte(n,z80.c)},n[178]=function(n){tstates+=8;z80.d=readbyte(n)&191;writebyte(n,z80.d)},n[179]=function(n){tstates+=8;z80.e=readbyte(n)&191;writebyte(n,z80.e)},n[180]=function(n){tstates+=8;z80.h=readbyte(n)&191;writebyte(n,z80.h)},n[181]=function(n){tstates+=8;z80.l=readbyte(n)&191;writebyte(n,z80.l)},n[182]=function(n){tstates+=8;writebyte(n,readbyte(n)&191)},n[183]=function(n){tstates+=8;z80.a=readbyte(n)&191;writebyte(n,z80.a)},n[184]=function(n){tstates+=8;z80.b=readbyte(n)&127;writebyte(n,z80.b)},n[185]=function(n){tstates+=8;z80.c=readbyte(n)&127;writebyte(n,z80.c)},n[186]=function(n){tstates+=8;z80.d=readbyte(n)&127;writebyte(n,z80.d)},n[187]=function(n){tstates+=8;z80.e=readbyte(n)&127;writebyte(n,z80.e)},n[188]=function(n){tstates+=8;z80.h=readbyte(n)&127;writebyte(n,z80.h)},n[189]=function(n){tstates+=8;z80.l=readbyte(n)&127;writebyte(n,z80.l)},n[190]=function(n){tstates+=8;writebyte(n,readbyte(n)&127)},n[191]=function(n){tstates+=8;z80.a=readbyte(n)&127;writebyte(n,z80.a)},n[192]=function(n){tstates+=8;z80.b=readbyte(n)|1;writebyte(n,z80.b)},n[193]=function(n){tstates+=8;z80.c=readbyte(n)|1;writebyte(n,z80.c)},n[194]=function(n){tstates+=8;z80.d=readbyte(n)|1;writebyte(n,z80.d)},n[195]=function(n){tstates+=8;z80.e=readbyte(n)|1;writebyte(n,z80.e)},n[196]=function(n){tstates+=8;z80.h=readbyte(n)|1;writebyte(n,z80.h)},n[197]=function(n){tstates+=8;z80.l=readbyte(n)|1;writebyte(n,z80.l)},n[198]=function(n){tstates+=8;writebyte(n,readbyte(n)|1)},n[199]=function(n){tstates+=8;z80.a=readbyte(n)|1;writebyte(n,z80.a)},n[200]=function(n){tstates+=8;z80.b=readbyte(n)|2;writebyte(n,z80.b)},n[201]=function(n){tstates+=8;z80.c=readbyte(n)|2;writebyte(n,z80.c)},n[202]=function(n){tstates+=8;z80.d=readbyte(n)|2;writebyte(n,z80.d)},n[203]=function(n){tstates+=8;z80.e=readbyte(n)|2;writebyte(n,z80.e)},n[204]=function(n){tstates+=8;z80.h=readbyte(n)|2;writebyte(n,z80.h)},n[205]=function(n){tstates+=8;z80.l=readbyte(n)|2;writebyte(n,z80.l)},n[206]=function(n){tstates+=8;writebyte(n,readbyte(n)|2)},n[207]=function(n){tstates+=8;z80.a=readbyte(n)|2;writebyte(n,z80.a)},n[208]=function(n){tstates+=8;z80.b=readbyte(n)|4;writebyte(n,z80.b)},n[209]=function(n){tstates+=8;z80.c=readbyte(n)|4;writebyte(n,z80.c)},n[210]=function(n){tstates+=8;z80.d=readbyte(n)|4;writebyte(n,z80.d)},n[211]=function(n){tstates+=8;z80.e=readbyte(n)|4;writebyte(n,z80.e)},n[212]=function(n){tstates+=8;z80.h=readbyte(n)|4;writebyte(n,z80.h)},n[213]=function(n){tstates+=8;z80.l=readbyte(n)|4;writebyte(n,z80.l)},n[214]=function(n){tstates+=8;writebyte(n,readbyte(n)|4)},n[215]=function(n){tstates+=8;z80.a=readbyte(n)|4;writebyte(n,z80.a)},n[216]=function(n){tstates+=8;z80.b=readbyte(n)|8;writebyte(n,z80.b)},n[217]=function(n){tstates+=8;z80.c=readbyte(n)|8;writebyte(n,z80.c)},n[218]=function(n){tstates+=8;z80.d=readbyte(n)|8;writebyte(n,z80.d)},n[219]=function(n){tstates+=8;z80.e=readbyte(n)|8;writebyte(n,z80.e)},n[220]=function(n){tstates+=8;z80.h=readbyte(n)|8;writebyte(n,z80.h)},n[221]=function(n){tstates+=8;z80.l=readbyte(n)|8;writebyte(n,z80.l)},n[222]=function(n){tstates+=8;writebyte(n,readbyte(n)|8)},n[223]=function(n){tstates+=8;z80.a=readbyte(n)|8;writebyte(n,z80.a)},n[224]=function(n){tstates+=8;z80.b=readbyte(n)|16;writebyte(n,z80.b)},n[225]=function(n){tstates+=8;z80.c=readbyte(n)|16;writebyte(n,z80.c)},n[226]=function(n){tstates+=8;z80.d=readbyte(n)|16;writebyte(n,z80.d)},n[227]=function(n){tstates+=8;z80.e=readbyte(n)|16;writebyte(n,z80.e)},n[228]=function(n){tstates+=8;z80.h=readbyte(n)|16;writebyte(n,z80.h)},n[229]=function(n){tstates+=8;z80.l=readbyte(n)|16;writebyte(n,z80.l)},n[230]=function(n){tstates+=8;writebyte(n,readbyte(n)|16)},n[231]=function(n){tstates+=8;z80.a=readbyte(n)|16;writebyte(n,z80.a)},n[232]=function(n){tstates+=8;z80.b=readbyte(n)|32;writebyte(n,z80.b)},n[233]=function(n){tstates+=8;z80.c=readbyte(n)|32;writebyte(n,z80.c)},n[234]=function(n){tstates+=8;z80.d=readbyte(n)|32;writebyte(n,z80.d)},n[235]=function(n){tstates+=8;z80.e=readbyte(n)|32;writebyte(n,z80.e)},n[236]=function(n){tstates+=8;z80.h=readbyte(n)|32;writebyte(n,z80.h)},n[237]=function(n){tstates+=8;z80.l=readbyte(n)|32;writebyte(n,z80.l)},n[238]=function(n){tstates+=8;writebyte(n,readbyte(n)|32)},n[239]=function(n){tstates+=8;z80.a=readbyte(n)|32;writebyte(n,z80.a)},n[240]=function(n){tstates+=8;z80.b=readbyte(n)|64;writebyte(n,z80.b)},n[241]=function(n){tstates+=8;z80.c=readbyte(n)|64;writebyte(n,z80.c)},n[242]=function(n){tstates+=8;z80.d=readbyte(n)|64;writebyte(n,z80.d)},n[243]=function(n){tstates+=8;z80.e=readbyte(n)|64;writebyte(n,z80.e)},n[244]=function(n){tstates+=8;z80.h=readbyte(n)|64;writebyte(n,z80.h)},n[245]=function(n){tstates+=8;z80.l=readbyte(n)|64;writebyte(n,z80.l)},n[246]=function(n){tstates+=8;writebyte(n,readbyte(n)|64)},n[247]=function(n){tstates+=8;z80.a=readbyte(n)|64;writebyte(n,z80.a)},n[248]=function(n){tstates+=8;z80.b=readbyte(n)|128;writebyte(n,z80.b)},n[249]=function(n){tstates+=8;z80.c=readbyte(n)|128;writebyte(n,z80.c)},n[250]=function(n){tstates+=8;z80.d=readbyte(n)|128;writebyte(n,z80.d)},n[251]=function(n){tstates+=8;z80.e=readbyte(n)|128;writebyte(n,z80.e)},n[252]=function(n){tstates+=8;z80.h=readbyte(n)|128;writebyte(n,z80.h)},n[253]=function(n){tstates+=8;z80.l=readbyte(n)|128;writebyte(n,z80.l)},n[254]=function(n){tstates+=8;writebyte(n,readbyte(n)|128)},n[255]=function(n){tstates+=8;z80.a=readbyte(n)|128;writebyte(n,z80.a)},n[256]=function(){},z80_defaults(n),n}();var vram=[],vramUntwiddled=[],vdp_regs=[],palette=[],paletteR=[],paletteG=[],paletteB=[],paletteRGB=[],vdp_addr_state=0,vdp_mode_select=0,vdp_addr_latch=0,vdp_addr=0,vdp_current_line=0,vdp_status=0,vdp_pending_hblank=!1,vdp_hblank_counter=0;prev_border=null;borderColourCss=null;currentFrame=1;var ram=[],cartridgeRam=[],romBanks=[],pages=[],ramSelectRegister=0,romPageMask=0,canvas,ctx,imageData,fb8,fb32,joystick=65535,inputMode=0,soundChip,initialized=!1,framesPerSecond=50,scanLinesPerFrame=313,scanLinesPerSecond=scanLinesPerFrame*framesPerSecond,cpuHz=358e4,tstatesPerHblank=Math.ceil(cpuHz/scanLinesPerSecond)|0,event_next_event=tstatesPerHblank,tstates=0;var targetTimeout=1e3/framesPerSecond,pausedTimeout=2*targetTimeout,linesPerYield=20,lastFrame=Date.now(),cycles=0,cyclet=0;keys={87:1,83:2,65:4,68:8,32:16,13:32,38:1,40:2,37:4,39:8,90:16,88:32,82:4096};running=!1;currentRom=0,function(n){window.nipplejs=n()}(function(){function u(){}function i(n,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=n,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1},this.config(t),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=i.id,i.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}function t(n,i){var r=this;return r.nipples=[],r.idles=[],r.actives=[],r.ids=[],r.pressureIntervals={},r.manager=n,r.id=t.id,t.id+=1,r.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1},r.config(i),(r.options.mode==="static"||r.options.mode==="semi")&&(r.options.multitouch=!1),r.options.multitouch||(r.options.maxNumberOfNipples=1),r.updateBox(),r.prepareNipples(),r.bindings(),r.begin(),r.nipples}function r(t){var i=this,r;return i.ids={},i.index=0,i.collections=[],i.config(t),i.prepareCollections(),n.bindEvt(window,"resize",function(){clearTimeout(r);r=setTimeout(function(){var t,r=n.getScroll();i.collections.forEach(function(n){n.forEach(function(n){t=n.el.getBoundingClientRect();n.position={x:r.x+t.left,y:r.y+t.top}})})},100)}),i.collections}var h=!!("ontouchstart"in window),c=window.PointerEvent?!0:!1,l=window.MSPointerEvent?!0:!1,e={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},f,o={},n,s;return c?f=e.pointer:l?f=e.MSPointer:h?(f=e.touch,o=e.mouse):f=e.mouse,n={},n.distance=function(n,t){var i=t.x-n.x,r=t.y-n.y;return Math.sqrt(i*i+r*r)},n.angle=function(t,i){var r=i.x-t.x,u=i.y-t.y;return n.degrees(Math.atan2(u,r))},n.findCoord=function(t,i,r){var u={x:0,y:0};return r=n.radians(r),u.x=t.x-i*Math.cos(r),u.y=t.y-i*Math.sin(r),u},n.radians=function(n){return n*(Math.PI/180)},n.degrees=function(n){return n*(180/Math.PI)},n.bindEvt=function(n,t,i){for(var f=t.split(/[ ,]+/g),r,u=0;u<f.length;u+=1)r=f[u],n.addEventListener?n.addEventListener(r,i,!1):n.attachEvent&&n.attachEvent(r,i)},n.unbindEvt=function(n,t,i){for(var f=t.split(/[ ,]+/g),r,u=0;u<f.length;u+=1)r=f[u],n.removeEventListener?n.removeEventListener(r,i):n.detachEvent&&n.detachEvent(r,i)},n.trigger=function(n,t,i){var r=new CustomEvent(t,i);n.dispatchEvent(r)},n.prepareEvent=function(n){return n.preventDefault(),n.type.match(/^touch/)?n.changedTouches:n},n.getScroll=function(){var n=window.pageXOffset!==undefined?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=window.pageYOffset!==undefined?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:n,y:t}},n.applyPosition=function(n,t){t.top||t.right||t.bottom||t.left?(n.style.top=t.top,n.style.right=t.right,n.style.bottom=t.bottom,n.style.left=t.left):(n.style.left=t.x+"px",n.style.top=t.y+"px")},n.getTransitionStyle=function(t,i,r){var u=n.configStylePropertyObject(t),f,o,e,s;for(f in u)if(u.hasOwnProperty(f))if(typeof i=="string")u[f]=i+" "+r;else{for(o="",e=0,s=i.length;e<s;e+=1)o+=i[e]+" "+r+", ";u[f]=o.slice(0,-2)}return u},n.getVendorStyle=function(t,i){var r=n.configStylePropertyObject(t);for(var u in r)r.hasOwnProperty(u)&&(r[u]=i);return r},n.configStylePropertyObject=function(n){var t={},i;return t[n]="",i=["webkit","Moz","o"],i.forEach(function(i){t[i+n.charAt(0).toUpperCase()+n.slice(1)]=""}),t},n.extend=function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n},n.safeExtend=function(n,t){var r={};for(var i in n)n.hasOwnProperty(i)&&t.hasOwnProperty(i)?r[i]=t[i]:n.hasOwnProperty(i)&&(r[i]=n[i]);return r},n.map=function(n,t){if(n.length)for(var i=0,r=n.length;i<r;i+=1)t(n[i]);else t(n)},u.prototype.on=function(n,t){var i=this,f=n.split(/[ ,]+/g),r,u;for(i._handlers_=i._handlers_||{},u=0;u<f.length;u+=1)r=f[u],i._handlers_[r]=i._handlers_[r]||[],i._handlers_[r].push(t);return i},u.prototype.off=function(n,t){var i=this;return i._handlers_=i._handlers_||{},n===undefined?i._handlers_={}:t===undefined?i._handlers_[n]=null:i._handlers_[n]&&i._handlers_[n].indexOf(t)>=0&&i._handlers_[n].splice(i._handlers_[n].indexOf(t),1),i},u.prototype.trigger=function(n,t){var i=this,f=n.split(/[ ,]+/g),r,u;for(i._handlers_=i._handlers_||{},u=0;u<f.length;u+=1)r=f[u],i._handlers_[r]&&i._handlers_[r].length&&i._handlers_[r].forEach(function(n){n.call(i,{type:r,target:i},t)})},u.prototype.config=function(t){var i=this;i.options=i.defaults||{};t&&(i.options=n.safeExtend(i.options,t))},u.prototype.bindEvt=function(t,i){var r=this;return r._domHandlers_=r._domHandlers_||{},r._domHandlers_[i]=function(){typeof r["on"+i]=="function"?r["on"+i].apply(r,arguments):console.warn('[WARNING] : Missing "on'+i+'" handler.')},n.bindEvt(t,f[i],r._domHandlers_[i]),o[i]&&n.bindEvt(t,o[i],r._domHandlers_[i]),r},u.prototype.unbindEvt=function(t,i){var r=this;return r._domHandlers_=r._domHandlers_||{},n.unbindEvt(t,f[i],r._domHandlers_[i]),o[i]&&n.unbindEvt(t,o[i],r._domHandlers_[i]),delete r._domHandlers_[i],this},i.prototype=new u,i.constructor=i,i.id=0,i.prototype.buildEl=function(){return(this.ui={},this.options.dataOnly)?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)},i.prototype.stylize=function(){if(this.options.dataOnly)return this;var r=this.options.fadeTime+"ms",i=n.getVendorStyle("borderRadius","50%"),u=n.getTransitionStyle("transition","opacity",r),t={};return t.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},t.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},t.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5"},n.extend(t.el,u),n.extend(t.back,i),n.extend(t.front,i),this.applyStyles(t),this},i.prototype.applyStyles=function(n){var t,i;for(t in this.ui)if(this.ui.hasOwnProperty(t))for(i in n[t])this.ui[t].style[i]=n[t][i];return this},i.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)},i.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)},i.prototype.destroy=function(){clearTimeout(this.removeTimeout);clearTimeout(this.showTimeout);clearTimeout(this.restTimeout);this.trigger("destroyed",this.instance);this.removeFromDom();this.off()},i.prototype.show=function(n){var t=this;return t.options.dataOnly?t:(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout(function(){t.ui.el.style.opacity=1},0),t.showTimeout=setTimeout(function(){t.trigger("shown",t.instance);typeof n=="function"&&n.call(this)},t.options.fadeTime),t)},i.prototype.hide=function(n){var t=this;return t.options.dataOnly?t:(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout(function(){var i=t.options.mode==="dynamic"?"none":"block";t.ui.el.style.display=i;typeof n=="function"&&n.call(t);t.trigger("hidden",t.instance)},t.options.fadeTime),t.options.restJoystick&&t.restPosition(),t)},i.prototype.restPosition=function(t){var i=this,f,r,u;i.frontPosition={x:0,y:0};f=i.options.fadeTime+"ms";r={};r.front=n.getTransitionStyle("transition",["top","left"],f);u={front:{}};u.front={left:i.frontPosition.x+"px",top:i.frontPosition.y+"px"};i.applyStyles(r);i.applyStyles(u);i.restTimeout=setTimeout(function(){typeof t=="function"&&t.call(i);i.restCallback()},i.options.fadeTime)},i.prototype.restCallback=function(){var t=this,i={};i.front=n.getTransitionStyle("transition","none","");t.applyStyles(i);t.trigger("rested",t.instance)},i.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}},i.prototype.computeDirection=function(n){var i=n.angle.radian,u=Math.PI/4,h=Math.PI/2,f,o,s,e,t,r;if(i>u&&i<u*3&&!n.lockX?f="up":i>-u&&i<=u&&!n.lockY?f="left":i>-u*3&&i<=-u&&!n.lockX?f="down":n.lockY||(f="right"),n.lockY||(o=i>-h&&i<h?"left":"right"),n.lockX||(s=i>0?"up":"down"),n.force>this.options.threshold){e={};for(r in this.direction)this.direction.hasOwnProperty(r)&&(e[r]=this.direction[r]);t={};this.direction={x:o,y:s,angle:f};n.direction=this.direction;for(r in e)e[r]===this.direction[r]&&(t[r]=!0);if(t.x&&t.y&&t.angle)return n;t.x&&t.y||this.trigger("plain",n);t.x||this.trigger("plain:"+o,n);t.y||this.trigger("plain:"+s,n);t.angle||this.trigger("dir dir:"+f,n)}return n},t.prototype=new u,t.constructor=t,t.id=0,t.prototype.prepareNipples=function(){var n=this,t=n.nipples;t.on=n.on.bind(n);t.off=n.off.bind(n);t.options=n.options;t.destroy=n.destroy.bind(n);t.ids=n.ids;t.id=n.id;t.processOnMove=n.processOnMove.bind(n);t.processOnEnd=n.processOnEnd.bind(n);t.get=function(n){if(n===undefined)return t[0];for(var i=0,r=t.length;i<r;i+=1)if(t[i].identifier===n)return t[i];return!1}},t.prototype.bindings=function(){var n=this;n.bindEvt(n.options.zone,"start");n.options.zone.style.touchAction="none";n.options.zone.style.msTouchAction="none"},t.prototype.begin=function(){var n=this,i=n.options,t;i.mode==="static"&&(t=n.createNipple(i.position,n.manager.getIdentifier()),t.add(),n.idles.push(t))},t.prototype.createNipple=function(t,r){var o=this,s=n.getScroll(),h={},u=o.options,e,c,f;return t.x&&t.y?h={x:t.x-(s.x+o.box.left),y:t.y-(s.y+o.box.top)}:(t.top||t.right||t.bottom||t.left)&&(e=document.createElement("DIV"),e.style.display="hidden",e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left,e.style.position="absolute",u.zone.appendChild(e),c=e.getBoundingClientRect(),u.zone.removeChild(e),h=t,t={x:c.left+s.x,y:c.top+s.y}),f=new i(o,{color:u.color,size:u.size,threshold:u.threshold,fadeTime:u.fadeTime,dataOnly:u.dataOnly,restJoystick:u.restJoystick,restOpacity:u.restOpacity,mode:u.mode,identifier:r,position:t,zone:u.zone,frontPosition:{x:0,y:0}}),u.dataOnly||(n.applyPosition(f.ui.el,h),n.applyPosition(f.ui.front,f.frontPosition)),o.nipples.push(f),o.trigger("added "+f.identifier+":added",f),o.manager.trigger("added "+f.identifier+":added",f),o.bindNipple(f),f},t.prototype.updateBox=function(){var n=this;n.box=n.options.zone.getBoundingClientRect()},t.prototype.bindNipple=function(n){var t=this,r,i=function(n,i){r=n.type+" "+i.id+":"+n.type;t.trigger(r,i)};n.on("destroyed",t.onDestroyed.bind(t));n.on("shown hidden rested dir plain",i);n.on("dir:up dir:right dir:down dir:left",i);n.on("plain:up plain:right plain:down plain:left",i)},t.prototype.pressureFn=function(n,t,i){var r=this,u=0;clearInterval(r.pressureIntervals[i]);r.pressureIntervals[i]=setInterval(function(){var i=n.force||n.pressure||n.webkitForce||0;i!==u&&(t.trigger("pressure",i),r.trigger("pressure "+t.identifier+":pressure",i),u=i)}.bind(r),100)},t.prototype.onstart=function(t){var i=this,u=i.options,r;return t=n.prepareEvent(t),i.updateBox(),r=function(n){i.actives.length<u.maxNumberOfNipples&&i.processOnStart(n)},n.map(t,r),i.manager.bindDocument(),!1},t.prototype.processOnStart=function(t){var i=this,e=i.options,o,u=i.manager.getIdentifier(t),c=t.force||t.pressure||t.webkitForce||0,s={x:t.pageX,y:t.pageY},r=i.getOrCreate(u,s),f,h;if(r.identifier!==u&&i.manager.removeIdentifier(r.identifier),r.identifier=u,f=function(n){n.trigger("start",n);i.trigger("start "+n.id+":start",n);n.show();c>0&&i.pressureFn(t,n,n.identifier);i.processOnMove(t)},(o=i.idles.indexOf(r))>=0&&i.idles.splice(o,1),i.actives.push(r),i.ids.push(r.identifier),e.mode!=="semi")f(r);else if(h=n.distance(s,r.position),h<=e.catchDistance)f(r);else{r.destroy();i.processOnStart(t);return}return r},t.prototype.getOrCreate=function(n,t){var i=this,u=i.options,r;return/(semi|static)/.test(u.mode)?(r=i.idles[0],r)?(i.idles.splice(0,1),r):u.mode==="semi"?i.createNipple(t,n):(console.warn("Coudln't find the needed nipple."),!1):i.createNipple(t,n)},t.prototype.processOnMove=function(t){var f=this,e=f.options,h=f.manager.getIdentifier(t),i=f.nipples.get(h),l,a,u;if(!i){console.error("Found zombie joystick with ID "+h);f.manager.removeIdentifier(h);return}i.identifier=h;var c=i.options.size/2,r={x:t.pageX,y:t.pageY},o=n.distance(r,i.position),s=n.angle(r,i.position),v=n.radians(s),y=o/c;o>c&&(o=c,r=n.findCoord(i.position,o,s));l=r.x-i.position.x;a=r.y-i.position.y;e.lockX&&(a=0);e.lockY&&(l=0);i.frontPosition={x:l,y:a};e.dataOnly||n.applyPosition(i.ui.front,i.frontPosition);u={identifier:i.identifier,position:r,force:y,pressure:t.force||t.pressure||t.webkitForce||0,distance:o,angle:{radian:v,degree:s},instance:i,lockX:e.lockX,lockY:e.lockY};u=i.computeDirection(u);u.angle={radian:n.radians(180-s),degree:180-s};i.trigger("move",u);f.trigger("move "+i.id+":move",u)},t.prototype.processOnEnd=function(n){var i=this,r=i.options,f=i.manager.getIdentifier(n),t=i.nipples.get(f),u=i.manager.removeIdentifier(t.identifier);t&&(r.dataOnly||t.hide(function(){r.mode==="dynamic"&&(t.trigger("removed",t),i.trigger("removed "+t.id+":removed",t),i.manager.trigger("removed "+t.id+":removed",t),t.destroy())}),clearInterval(i.pressureIntervals[t.identifier]),t.resetDirection(),t.trigger("end",t),i.trigger("end "+t.id+":end",t),i.ids.indexOf(t.identifier)>=0&&i.ids.splice(i.ids.indexOf(t.identifier),1),i.actives.indexOf(t)>=0&&i.actives.splice(i.actives.indexOf(t),1),/(semi|static)/.test(r.mode)?i.idles.push(t):i.nipples.indexOf(t)>=0&&i.nipples.splice(i.nipples.indexOf(t),1),i.manager.unbindDocument(),/(semi|static)/.test(r.mode)&&(i.manager.ids[u.id]=u.identifier))},t.prototype.onDestroyed=function(n,t){var i=this;i.nipples.indexOf(t)>=0&&i.nipples.splice(i.nipples.indexOf(t),1);i.actives.indexOf(t)>=0&&i.actives.splice(i.actives.indexOf(t),1);i.idles.indexOf(t)>=0&&i.idles.splice(i.idles.indexOf(t),1);i.ids.indexOf(t.identifier)>=0&&i.ids.splice(i.ids.indexOf(t.identifier),1);i.manager.removeIdentifier(t.identifier);i.manager.unbindDocument()},t.prototype.destroy=function(){var n=this,t;n.unbindEvt(n.options.zone,"start");n.nipples.forEach(function(n){n.destroy()});for(t in n.pressureIntervals)n.pressureIntervals.hasOwnProperty(t)&&clearInterval(n.pressureIntervals[t]);n.trigger("destroyed",n.nipples);n.manager.unbindDocument();n.off()},r.prototype=new u,r.constructor=r,r.prototype.prepareCollections=function(){var n=this;n.collections.create=n.create.bind(n);n.collections.on=n.on.bind(n);n.collections.off=n.off.bind(n);n.collections.destroy=n.destroy.bind(n);n.collections.get=function(t){var i;return n.collections.every(function(n){return(i=n.get(t))?!1:!0}),i}},r.prototype.create=function(n){return this.createCollection(n)},r.prototype.createCollection=function(n){var i=this,r=new t(i,n);return i.bindCollection(r),i.collections.push(r),r},r.prototype.bindCollection=function(n){var t=this,r,i=function(n,i){r=n.type+" "+i.id+":"+n.type;t.trigger(r,i)};n.on("destroyed",t.onDestroyed.bind(t));n.on("shown hidden rested dir plain",i);n.on("dir:up dir:right dir:down dir:left",i);n.on("plain:up plain:right plain:down plain:left",i)},r.prototype.bindDocument=function(){var n=this;n.binded||(n.bindEvt(document,"move").bindEvt(document,"end"),n.binded=!0)},r.prototype.unbindDocument=function(n){var t=this;Object.keys(t.ids).length&&n!==!0||(t.unbindEvt(document,"move").unbindEvt(document,"end"),t.binded=!1)},r.prototype.getIdentifier=function(n){var t;return n?(t=n.identifier===undefined?n.pointerId:n.identifier,t===undefined&&(t=this.latest||0)):t=this.index,this.ids[t]===undefined&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]},r.prototype.removeIdentifier=function(n){var i={};for(var t in this.ids)if(this.ids[t]===n){i.id=t;i.identifier=this.ids[t];delete this.ids[t];break}return i},r.prototype.onmove=function(n){var t=this;t.onAny("move",n);return!1},r.prototype.onend=function(n){var t=this;t.onAny("end",n);return!1},r.prototype.oncancel=function(n){var t=this;t.onAny("end",n);return!1},r.prototype.onAny=function(t,i){var r=this,u,o="processOn"+t.charAt(0).toUpperCase()+t.slice(1),f,e;return i=n.prepareEvent(i),f=function(n,t,i){i.ids.indexOf(t)>=0&&(i[o](n),n._found_=!0)},e=function(t){u=r.getIdentifier(t);n.map(r.collections,f.bind(null,t,u));t._found_||r.removeIdentifier(u)},n.map(i,e),!1},r.prototype.destroy=function(){var n=this;n.unbindDocument(!0);n.ids={};n.index=0;n.collections.forEach(function(n){n.destroy()});n.off()},r.prototype.onDestroyed=function(n,t){var i=this;if(i.collections.indexOf(t)<0)return!1;i.collections.splice(i.collections.indexOf(t),1)},s=new r,{create:function(n){return s.create(n)},factory:s}}),function(){function t(){n.display("#mouse-triggers");n.addClickHandler("#trig-audio",function(t){return audio_enable(!0),n.display("#trig-audio",!1),n.display("#trig-no-audio"),n.cancelEvent(t)});n.addClickHandler("#trig-no-audio",function(t){return audio_enable(!1),n.display("#trig-audio"),n.display("#trig-no-audio",!1),n.cancelEvent(t)});n.addClickHandler("#trig-load",function(t){return loadNextRom(),n.cancelEvent(t)});n.addClickHandler("#trig-pause",function(t){return z80_nmi(),n.cancelEvent(t)});n.addClickHandler("#trig-reset",function(t){return reset(),n.cancelEvent(t)})}function i(){var i={zone:document.getElementById("dpad-area"),color:"#DDDDDD",mode:"static",position:{left:"22%",bottom:"80px"}},n,t;nipplejs.create(i).on("dir:up",function(){joystick&=-2;joystick|=2}).on("dir:down",function(){joystick&=-3;joystick|=1}).on("dir:left",function(){joystick&=-5;joystick|=8}).on("dir:right",function(){joystick&=-9;joystick|=4}).on("end",function(){joystick|=15});n={zone:document.getElementById("trig1-area"),color:"#DDDDDD",mode:"static",position:{right:"33%",bottom:"80px"},lockX:!0,lockY:!0};nipplejs.create(n).on("start",function(){joystick&=-17}).on("end",function(){joystick|=16});t={zone:document.getElementById("trig2-area"),color:"#DDDDDD",mode:"static",position:{right:"11%",bottom:"80px"},lockX:!0,lockY:!0};nipplejs.create(t).on("start",function(){joystick&=-33}).on("end",function(){joystick|=32})}var n=global.x;n.versions.push("Shinobi/v1.0.0000");console.log(document.childNodes[1].textContent);n.extendClass(n.Game,global,"Shinobi",n.noop,function(r){var f=256,e=192,u=e/f;r.initialize=function(){if(!("Uint8Array"in window)||!("XMLHttpRequest"in window)||!("overrideMimeType"in XMLHttpRequest.prototype))return this.blue(":/ please move to a modern browser");this.view=document.getElementById("game-view");this.view.width=f;this.view.height=e;n.text("#title",document.childNodes[1].textContent);n.text("#instr","* * * TOUCH or PRESS A BUTTON OR KEY TO START * * *");n.displayLayout()};r.go=function(){var r=document.getElementById("title-play");this.onFirstInput(r,{keyboard:!0,mouse:!0,touch:!0},function(u){r.style.display="none";u.keyboard&&(n.html("#keyboard-keys",strings.PlayerKeys+"<br>"+strings.ConsoleKeys),n.display("#keyboard-keys"));u.mouse&&(n.html("#keyboard-keys",strings.PlayerMouse+"<br>"+strings.ConsoleKeys),n.display("#keyboard-keys"),t());u.touch&&(n.display("#mouse-triggers"),n.display("#touch-triggers"),t(),i());n.debug||n.app.fullScreen();go()})};r.layout=function(t,i){n.write(t+"x"+i);var r,f,e=i/t;e>u?(r=t,f=Math.floor(t*u)):(r=Math.floor(i/u),f=i);this.view.style.width=r+"px";this.view.style.height=f+"px"};r.resume=function(){start();z80_nmi();n.uncover()};r.suspend=function(){n.cover();z80_nmi();stop()}});Shinobi()}();